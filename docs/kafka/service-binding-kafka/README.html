<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Binding OpenShift applications to OpenShift Streams for Apache Kafka</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body id="chap-binding-openshift-applications" class="article">
<div id="header">
<h1>Binding OpenShift applications to OpenShift Streams for Apache Kafka</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a developer of applications and services, you can connect applications deployed on a Kubernetes platform such as Red Hat OpenShift to Kafka instances created in OpenShift Streams for Apache Kafka.</p>
</div>
<div class="paragraph">
<p>For example, suppose you have the following applications deployed on OpenShift:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One application that publishes price updates for a variety of stocks</p>
</li>
<li>
<p>A second application that consumes the price updates for publication on a web page</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, you have a Kafka instance in Streams for Apache Kafka. Each time the first application produces a price update, you want to use the Kafka instance to forward the update as an event to the second, consuming application.</p>
</div>
<div class="paragraph">
<p>To achieve this behavior, you need a way to connect the applications to your Kafka instance in Streams for Apache Kafka.</p>
</div>
<div class="paragraph">
<p>You can use a specialized Operator called the Service Binding Operator to automatically provide an application on Kubernetes with the parameters required to connect to a Kafka instance in Streams for Apache Kafka. This process is called <em>service binding</em>.</p>
</div>
<div class="paragraph">
<p>This guide describes how to perform service binding. The Kubernetes platform referred to in the remainder of this guide is Red Hat OpenShift.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-about-service-binding_service-binding">About service binding</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>You can use a specialized Operator called the Service Binding Operator to automatically provide an application on OpenShift with the parameters required to connect to a Kafka instance in OpenShift Streams for Apache Kafka. This process is called <em>service binding</em>. To perform service binding, you must also install the Red Hat OpenShift Application Services (RHOAS) Operator.</p>
</div>
<div class="paragraph">
<p>The RHOAS Operator exposes a Kafka instance to an OpenShift cluster. The Service Binding Operator collects and shares the information that an application running on the OpenShift cluster needs to connect to the Kafka instance.</p>
</div>
<div class="paragraph">
<p>When the RHOAS Operator and Service Binding Operator are installed, you can use the RHOAS command-line interface (CLI) or OpenShift web console to perform service binding. When connection between your application and Kafka instance is established, you can then work directly with the Kafka instance using standard OpenShift features and APIs.</p>
</div>
<div class="paragraph">
<p>When you perform service binding, the Service Binding Operator injects connection parameters for the Kafka instance into the pod for your application, as files. The Service Binding Operator creates the following directory and file structure in the application pod:</p>
</div>
<div class="listingblock">
<div class="title">Files injected by the Service Binding Operator</div>
<div class="content">
<pre class="highlight"><code>/bindings/<em>&lt;kafka-instance-name&gt;</em>
├── bootstrapServers
├── password
├── provider
├── saslMechanism
├── securityProtocol
├── type
└── user</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each file injected by the Service Binding Operator contains a connection parameter specified in plain text. The following list describes the parameters.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">bootstrapServers</dt>
<dd>
<p>Bootstrap server endpoint for the Kafka instance.</p>
</dd>
<dt class="hdlist1">password</dt>
<dd>
<p>Password for connection to the Kafka instance.</p>
</dd>
<dt class="hdlist1">provider</dt>
<dd>
<p>Cloud provider for the Kafka instance.</p>
</dd>
<dt class="hdlist1">saslMechanism</dt>
<dd>
<p>Simple Authentication and Security Layer (SASL) mechanism used by the Kafka instance for client authentication.</p>
</dd>
<dt class="hdlist1">securityProtocol</dt>
<dd>
<p>Protocol used by the Kafka instance to secure client connections.</p>
</dd>
<dt class="hdlist1">type</dt>
<dd>
<p>Metadata that identifies the Red Hat OpenShift Application Services (RHOAS) service. For a Kafka instance in Streams for Apache Kafka, this is set to a value of <code>kafka</code>.</p>
</dd>
<dt class="hdlist1">user</dt>
<dd>
<p>User name for connection to the Kafka instance.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-installing-service-binding-operator_service-binding">Installing the Service Binding Operator on OpenShift</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Before you can bind Kafka instances in OpenShift Streams for Apache Kafka to applications on OpenShift, you need to install the Service Binding Operator on your OpenShift cluster. The following procedure shows how to use the OperatorHub interface in the OpenShift web console to install the Service Binding Operator.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You can access your OpenShift cluster with the <code>dedicated-admin</code> role (OpenShift Dedicated) or <code>cluster-admin</code> role. Only these roles have privileges to install an Operator on a cluster.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the OpenShift web console with the <code>dedicated-admin</code> role (OpenShift Dedicated) or <code>cluster-admin</code> role.</p>
</li>
<li>
<p>Click the perspective switcher in the upper-left corner. Switch to the <strong>Administrator</strong> perspective.</p>
</li>
<li>
<p>In the left menu, click <strong>Operators</strong> &gt; <strong>OperatorHub</strong>.</p>
</li>
<li>
<p>In the <strong>Filter by keyword</strong> field, enter <code>Service Binding</code>.</p>
</li>
<li>
<p>In the filtered results, click <strong>Service Binding Operator</strong>.</p>
<div class="paragraph">
<p>An information sidebar for the Service Binding Operator opens.</p>
</div>
</li>
<li>
<p>In the sidebar, review the information about the Service Binding Operator and click <strong>Install</strong>.</p>
</li>
<li>
<p>On the <strong>Install Operator</strong> page, perform the following actions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For the <strong>Update channel</strong> option, ensure that <code>beta</code> is selected.</p>
</li>
<li>
<p>For the <strong>Installation mode</strong> option, ensure that <code>All namespaces on the cluster</code> is selected.</p>
</li>
<li>
<p>For the <strong>Installed Namespace</strong> and <strong>Update approval</strong> options, keep the default values.</p>
</li>
<li>
<p>Click <strong>Install</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>When the installation process is finished, click <strong>View Operator</strong> to see the Operator details.</p>
<div class="paragraph">
<p>The <strong>Operator details</strong> page for the Service Binding Operator opens in the <strong>Installed Operators</strong> section of the web console.</p>
</div>
<div class="paragraph">
<p>On the <strong>Operator details</strong> page, the <strong>Status</strong> field shows a value of <code>Succeeded</code>.</p>
</div>
<div class="paragraph">
<p>Also, you can observe that the Service Binding Operator is installed in the <code>openshift-operators</code> namespace.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-installing-rhoas-operator_service-binding">Installing the RHOAS Operator on OpenShift</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Before you can bind Kafka instances in OpenShift Streams for Apache Kafka to applications on OpenShift, you need to install the Red Hat OpenShift Application Services (RHOAS) Operator on your OpenShift cluster. The following procedure shows how to use the OperatorHub interface in the OpenShift web console to install the RHOAS Operator.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You can access your OpenShift cluster with the <code>dedicated-admin</code> role (OpenShift Dedicated) or <code>cluster-admin</code> role. Only these roles have privileges to install an Operator on a cluster.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the OpenShift web console with the <code>dedicated-admin</code> role (OpenShift Dedicated) or <code>cluster-admin</code> role.</p>
</li>
<li>
<p>Click the perspective switcher in the upper-left corner. Switch to the <strong>Administrator</strong> perspective.</p>
</li>
<li>
<p>In the left menu, click <strong>Operators</strong> &gt; <strong>OperatorHub</strong>.</p>
</li>
<li>
<p>In the <strong>Filter by keyword</strong> field, enter <code>RHOAS</code>.</p>
</li>
<li>
<p>In the filtered results, select the <strong>OpenShift Application Services (RHOAS)</strong> Operator.</p>
</li>
<li>
<p>If you see a dialog box entitled <strong>Show community Operator</strong>, review the included information. When you have finished, click <strong>Continue</strong>.</p>
<div class="paragraph">
<p>An information sidebar for the RHOAS Operator opens.</p>
</div>
</li>
<li>
<p>In the sidebar, review the information about the RHOAS Operator and click <strong>Install</strong>.</p>
</li>
<li>
<p>On the <strong>Install Operator</strong> page, perform the following actions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For the <strong>Installation mode</strong> option, ensure that <code>All namespaces on the cluster</code> is selected.</p>
</li>
<li>
<p>For the <strong>Update channel</strong>, <strong>Installed Namespace</strong>, and <strong>Update approval</strong> options, keep the default values.</p>
</li>
<li>
<p>Click <strong>Install</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>When the installation process is finished, click <strong>View Operator</strong> to see the Operator details.</p>
<div class="paragraph">
<p>The <strong>Operator details</strong> page for the RHOAS Operator opens in the <strong>Installed Operators</strong> section of the web console.</p>
</div>
<div class="paragraph">
<p>On the <strong>Operator details</strong> page, the <strong>Status</strong> field shows a value of <code>Succeeded</code>.</p>
</div>
<div class="paragraph">
<p>Also, you can observe that the RHOAS Operator is installed in the <code>openshift-operators</code> namespace.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-verifying-connection-to-openshift-cluster_service-binding">Verifying connection to your OpenShift cluster</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>After you install the RHOAS Operator, you can verify that the Operator is working by using the RHOAS CLI to connect to your OpenShift cluster and retrieve the cluster status. The following example shows how to verify connection to your OpenShift cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The RHOAS Operator is installed on your OpenShift cluster.</p>
</li>
<li>
<p>You can access your OpenShift cluster with privileges to create a new project.</p>
</li>
<li>
<p>You have installed the OpenShift CLI.</p>
</li>
<li>
<p>You have installed the latest version of the RHOAS CLI (see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/rhoas/rhoas-cli-installation/README.adoc" target="_blank" rel="noopener">Installing and configuring the rhoas CLI</a>).</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On your computer, open a command-line window.</p>
</li>
<li>
<p>Log in to the OpenShift CLI using a token.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the OpenShift web console as a user who has privileges to create a new project in the cluster.</p>
</li>
<li>
<p>In the upper-right corner of the console, click your user name. Select <strong>Copy login command</strong>.</p>
<div class="paragraph">
<p>A new page opens.</p>
</div>
</li>
<li>
<p>Click the <strong>Display Token</strong> link.</p>
</li>
<li>
<p>In the section entitled <strong>Log in with this token</strong>, copy the full <code>oc login</code> command shown.</p>
</li>
<li>
<p>On the command line, paste the login command you copied. Right-click on the command line and select <strong>Paste</strong>.</p>
<div class="paragraph">
<p>You see output confirming that you are logged in to your OpenShift cluster and the current project that you are using.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>On the command line, use the OpenShift CLI to create a new project, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example OpenShift CLI command to create new project</div>
<div class="content">
<pre class="highlight"><code>$ oc new-project my-project</code></pre>
</div>
</div>
</li>
<li>
<p>Log in to the RHOAS CLI.</p>
<div class="listingblock">
<div class="title">RHOAS CLI login command</div>
<div class="content">
<pre class="highlight"><code>$ rhoas login</code></pre>
</div>
</div>
<div class="paragraph">
<p>The login command opens a sign-in process in your web browser.</p>
</div>
</li>
<li>
<p>On the command line, use the RHOAS CLI to connect to your OpenShift cluster and retrieve the cluster status.</p>
<div class="listingblock">
<div class="title">RHOAS CLI command to retrieve status of OpenShift cluster</div>
<div class="content">
<pre class="highlight"><code>$ rhoas cluster status
Namespace: my-project
RHOAS Operator: Installed</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the output, the RHOAS CLI indicates that the RHOAS Operator was successfully installed. The CLI also retrieves the name of the current OpenShift project (namespace).</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-connecting-kafka-instance-to-openshift-cluster_service-binding">Connecting a Kafka instance to your OpenShift cluster</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>When you have verified connection to your OpenShift cluster, you can connect a Kafka instance in OpenShift Streams for Apache Kafka to the current project in the cluster. You must establish this connection before you can bind applications running in the project to the Kafka instance. The following example shows how to use the RHOAS CLI to connect a specified Kafka instance to a project in your cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the RHOAS Operator and verified connection to your OpenShift cluster.</p>
</li>
<li>
<p>You have a running Kafka instance in Streams for Apache Kafka (see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/getting-started-kafka/README.adoc" target="_blank" rel="noopener">Getting started with OpenShift Streams for Apache Kafka</a>).</p>
</li>
<li>
<p>You have an API token to connect to your Kafka instance. To get a token, see the <a href="https://console.redhat.com/openshift/token" target="_blank" rel="noopener">OpenShift Cluster Manager API Token</a> page.</p>
</li>
<li>
<p>You understand how Access Control Lists (ACLs) enable you to manage how user accounts and service accounts can access the Kafka resources that you create. See <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/access-mgmt-kafka/README.adoc" target="_blank" rel="noopener">Managing account access in OpenShift Streams for Apache Kafka</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>If you are not already logged in to the OpenShift CLI, log in using a token, as described in <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/service-binding-kafka/README.adoc#proc-verifying-connection-to-openshift-cluster_service-binding">Verifying connection to your OpenShift cluster</a>.</p>
</li>
<li>
<p>Log in to the RHOAS CLI.</p>
<div class="listingblock">
<div class="title">RHOAS CLI login command</div>
<div class="content">
<pre class="highlight"><code>$ rhoas login</code></pre>
</div>
</div>
</li>
<li>
<p>Use the OpenShift CLI to specify the current OpenShift project. Specify the project that you created when verifying connection to your OpenShift cluster, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example OpenShift CLI command to specify current project</div>
<div class="content">
<pre class="highlight"><code>$ oc project my-project</code></pre>
</div>
</div>
</li>
<li>
<p>Use the RHOAS CLI to connect a Kafka instance in Streams for Apache Kafka to the current project in your OpenShift cluster.</p>
<div class="listingblock">
<div class="title">RHOAS CLI command to connect Kafka instance to OpenShift cluster</div>
<div class="content">
<pre class="highlight"><code>$ rhoas cluster connect</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are prompted to specify the service that you want to connect to OpenShift.</p>
</div>
</li>
<li>
<p>Use the up and down arrows on your keyboard to highlight the <code>kafka</code> service. Press <strong>Enter</strong>.</p>
<div class="paragraph">
<p>You are prompted to specify the Kafka instance that you want to connect to OpenShift.</p>
</div>
</li>
<li>
<p>If you have more than one Kafka instance, use the up and down arrows on your keyboard to highlight the instance that you want to connect to OpenShift. Press <strong>Enter</strong>.</p>
<div class="paragraph">
<p>You see output like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example connection details</div>
<div class="content">
<pre class="highlight nowrap"><code>Connection Details:

Service Type: kafka
Service Name: my-kafka-instance
Kubernetes Namespace:  my-project
Service Account Secret: rh-cloud-services-service-account</code></pre>
</div>
</div>
</li>
<li>
<p>Verify the connection details shown by the RHOAS CLI. When you are ready to continue, type <code>y</code> and then press <strong>Enter</strong>.</p>
<div class="paragraph">
<p>You are prompted to provide an access token. The RHOAS Operator requires this token to connect to your Kafka instance.</p>
</div>
</li>
<li>
<p>In your web browser, open the <a href="https://console.redhat.com/openshift/token" target="_blank" rel="noopener">OpenShift Cluster Manager API Token</a> page.</p>
</li>
<li>
<p>On the OpenShift Cluster Manager API Token page, click <strong>Load token</strong>. When the page is refreshed, copy the API token shown.</p>
</li>
<li>
<p>On the command line, right-click and select <strong>Paste</strong>. Press <strong>Enter</strong>.</p>
<div class="paragraph">
<p>The RHOAS Operator uses the API token to create a <code>KafkaConnection</code> object on your OpenShift cluster. When this process is complete, you see output like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example output from rhoas cluster connect command</div>
<div class="content">
<pre class="highlight nowrap"><code>Service Account Secret "rh-cloud-services-service-account" created successfully
Client ID: <em>&lt;client_id&gt;</em>
...
KafkaConnection resource "my-kafka-instance" has been created
Waiting for status from KafkaConnection resource.
Created KafkaConnection can be injected into your application.
...
KafkaConnection successfully installed on your cluster.</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the output, the RHOAS Operator creates a new service account to access your Kafka instance in Streams for Apache Kafka. The Operator stores the service account information in a secret.</p>
</div>
<div class="paragraph">
<p>The RHOAS Operator also creates a <code>KafkaConnection</code> object for your Kafka instance, which connects the instance to the OpenShift cluster. When you bind your Kafka instance to an application on OpenShift, the Service Binding Operator uses the <code>KafkaConnection</code> object to provide the application with the necessary connection information for the instance. Binding an application to your Kafka instance is described later in this guide.</p>
</div>
</li>
<li>
<p>Set Access Control List (ACL) permissions to enable the new service account created by the RHOAS Operator to access resources in your Kafka instance. To set permissions, use the <code>Client ID</code> value for the service account.</p>
<div class="listingblock">
<div class="title">RHOAS CLI command to set access permissions for service account</div>
<div class="content">
<pre class="highlight"><code>$ rhoas kafka acl grant-access --consumer --producer \
    --service-account <em>&lt;client_id&gt;</em> --topic "*" --group "*"

The following ACL rules are to be created:

  PRINCIPAL (7)   PERMISSION         DESCRIPTION
  --------------  ----------------   -------------
  <em>&lt;client_id&gt;</em>     ALLOW | DESCRIBE   TOPIC is "*"
  <em>&lt;client_id&gt;</em>     ALLOW | READ       TOPIC is "*"
  <em>&lt;client_id&gt;</em>     ALLOW | READ       GROUP is "*"
  <em>&lt;client_id&gt;</em>     ALLOW | WRITE      TOPIC is "*"
  <em>&lt;client_id&gt;</em>     ALLOW | CREATE     TOPIC is "*"
  <em>&lt;client_id&gt;</em>     ALLOW | WRITE      TRANSACTIONAL_ID is "*"
  <em>&lt;client_id&gt;</em>     ALLOW | DESCRIBE   TRANSACTIONAL_ID is "*"

? Are you sure you want to create the listed ACL rules (y/N) Yes
✔️ ACLs successfully created in the Kafka instance "my-kafka-instance"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command you entered allows applications to create topics in the instance, to produce and consume messages in any topic in the instance, and to use any consumer group.</p>
</div>
</li>
<li>
<p>Use the OpenShift CLI to verify that the RHOAS Operator successfully created the connection.</p>
<div class="listingblock">
<div class="title">OpenShift CLI command to verify Operator connection to cluster</div>
<div class="content">
<pre class="highlight"><code>$ oc get KafkaConnection

NAME   		         AGE
my-kafka-instance    2m35s</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the output, when you use the <code>rhoas cluster connect</code> command, the RHOAS Operator creates a <code>KafkaConnection</code> object that matches the name of your Kafka instance. In this example, the object name matches a Kafka instance called <code>my-kafka-instance</code>.</p>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_streams_for_apache_kafka/1/guide/2f4bf7cf-5de2-4254-8274-6bf71673f407" target="_blank" rel="noopener"> Managing account access in OpenShift Streams for Apache Kafka</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-binding-quarkus-application-using-cli_service-binding">Binding a Quarkus application to OpenShift Streams for Apache Kafka using the RHOAS CLI</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>When the RHOAS Operator is installed on your OpenShift cluster and you have connected a Kafka instance to the cluster, you can use the RHOAS CLI to instruct the Service Binding Operator to automatically inject an application running on the cluster with the parameters required to connect to the Kafka instance. This process is called <em>service binding</em>.</p>
</div>
<div class="paragraph">
<p>The following tutorial shows how to use the RHOAS CLI to perform service binding. In the tutorial, you create an example Quarkus application and connect this to a Kafka instance. <a href="https://quarkus.io/" target="_blank" rel="noopener">Quarkus</a> is a Kubernetes-native Java framework that is optimized for serverless, cloud, and Kubernetes environments.</p>
</div>
<div class="paragraph">
<p>When you perform service binding, the Service Binding Operator automatically injects connection parameters as files into the pod for the application. The example Quarkus application in this tutorial uses the <code>quarkus-kubernetes-service-binding</code> <a href="https://quarkus.io/guides/deploying-to-kubernetes#service-binding" target="_blank" rel="noopener">extension</a>. This means that the application automatically detects and uses the injected connection parameters.</p>
</div>
<div class="paragraph">
<p>In general, this automatic injection and detection of connection parameters eliminates the need to manually configure an application to connect to a Kafka instance in OpenShift Streams for Apache Kafka. This is a particular advantage if you have many applications in your project that you want to connect to a Kafka instance.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>The Service Binding Operator is installed on your OpenShift cluster.</p>
</li>
<li>
<p>The RHOAS Operator is installed on your OpenShift cluster and you have verified connection to the cluster.</p>
</li>
<li>
<p>You have connected a Kafka instance to a project in your OpenShift cluster.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="proc-deploying-example-quarkus-application-on-openshift_service-binding">Deploying an example Quarkus application on OpenShift</h3>
<div class="paragraph _abstract">
<p>In this step of the tutorial, you deploy an example Quarkus application in the OpenShift project that you previously connected your Kafka instance to.</p>
</div>
<div class="paragraph">
<p>The Quarkus application generates random numbers between 0 and 100 and produces those numbers to a Kafka topic. Another part of the application consumes the numbers from the Kafka topic. Finally, the application uses <em>server-sent events</em> to expose the numbers as a REST UI. A web page in the application displays the exposed numbers.</p>
</div>
<div class="paragraph">
<p>The example Quarkus application uses the <code>quarkus-kubernetes-service-binding</code> <a href="https://quarkus.io/guides/deploying-to-kubernetes#service-binding" target="_blank" rel="noopener">extension</a>, which means that the application automatically detects and uses the injected connection parameters. This eliminates the need for manual configuration of the application.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have privileges to deploy applications in the OpenShift project that you connected your Kafka instance to.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>If you are not already logged in to the OpenShift CLI, log in using a token, as described in <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/service-binding-kafka/README.adoc#proc-verifying-connection-to-openshift-cluster_service-binding">Verifying connection to your OpenShift cluster</a>. Log in as the same user who verified connection to the cluster.</p>
</li>
<li>
<p>Use the OpenShift CLI to ensure that the current OpenShift project is the one that you previously connected your Kafka instance to, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example OpenShift CLI command to specify current OpenShift project</div>
<div class="content">
<pre class="highlight"><code>$ oc project my-project</code></pre>
</div>
</div>
</li>
<li>
<p>To deploy the Quarkus application, apply an example application template provided by Streams for Apache Kafka.</p>
<div class="listingblock">
<div class="title">OpenShift CLI command to deploy example Quarkus application</div>
<div class="content">
<pre class="highlight nowrap"><code>$ oc apply -f https://raw.githubusercontent.com/redhat-developer/app-services-guides/main/code-examples/quarkus-kafka-quickstart/.kubernetes/kubernetes.yml

service/rhoas-quarkus-kafka created
deployment.apps/rhoas-quarkus-kafka created
route.route.openshift.io/rhoas-quarkus-kafka created</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the output, when you deploy the application, OpenShift creates a service and route for access to the application.</p>
</div>
</li>
<li>
<p>Get the URL of the route created for the application.</p>
<div class="listingblock">
<div class="title">OpenShift CLI command to get route for application</div>
<div class="content">
<pre class="highlight nowrap"><code>$ oc get route

NAME                   HOST/PORT
rhoas-quarkus-kafka    rhoas-quarkus-kafka-my-project.apps.sandbox-m2.ll9k.p1.openshiftapps.com</code></pre>
</div>
</div>
</li>
<li>
<p>On the command line, highlight the URL shown under <strong>HOST/PORT</strong>. Right-click and select <strong>Copy</strong>.</p>
</li>
<li>
<p>In your web browser, paste the URL for the route. Ensure that the URL includes <code>http://</code>.</p>
<div class="paragraph">
<p>A web page for the Quarkus application opens.</p>
</div>
</li>
<li>
<p>In your web browser, append <code>/prices.html</code> to the URL.</p>
<div class="paragraph">
<p>A new web page entitled <strong>Last price</strong> opens.  Because you haven&#8217;t yet connected the Quarkus application to your Kafka instance, the price value appears as <code>N/A</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-creating-prices-topic-in-kafka-instance_service-binding">Creating the prices topic in your Kafka instance</h3>
<div class="paragraph _abstract">
<p>In the previous step of this tutorial, you deployed an example application on OpenShift. The application is a Quarkus application that uses a Kafka topic called <code>prices</code> to produce and consume messages. In this step, you create the <code>prices</code> topic in your Kafka instance.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have deployed the example Quarkus application.</p>
</li>
<li>
<p>You have a running Kafka instance in Streams for Apache Kafka (see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/getting-started-kafka/README.adoc" target="_blank" rel="noopener">Getting started with OpenShift Streams for Apache Kafka</a>).</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the <a href="https://console.redhat.com/application-services/streams/" target="_blank" rel="noopener">Kafka Instances</a> page of the Streams for Apache Kafka web console, click the name of the Kafka instance that you want to add a topic to.</p>
</li>
<li>
<p>Select the <strong>Topics</strong> tab and click <strong>Create topic</strong>. On the topic creation page shown in the figure, follow the guided steps to define the details of the <code>prices</code> topic. Click <strong>Next</strong> to complete each step and click <strong>Finish</strong> to complete the setup.</p>
<div class="imageblock">
<div class="content">
<img src="./images/sak-create-prices-topic.png" alt="Image of wizard to create prices topic">
</div>
<div class="title">Figure 1. Guided steps to define topic</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following list describes the topic properties that you must specify.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Topic name</strong></dt>
<dd>
<p>Enter <code>prices</code> as the topic name.</p>
</dd>
<dt class="hdlist1"><strong>Partitions</strong></dt>
<dd>
<p>Set the number of partitions for this topic. For this tutorial, set a value of <code>1</code>. Partitions are distinct lists of messages within a topic and enable parts of a topic to be distributed over multiple brokers in the cluster. A topic can contain one or more partitions, enabling producer and consumer loads to be scaled.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can increase the number of partitions later, but you cannot decrease them.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><strong>Message retention</strong></dt>
<dd>
<p>Set the message retention time to the relevant value and increment. For this tutorial, set a value of <code>A week</code>. Message retention time is the amount of time that messages are retained in a topic before they are deleted or compacted, depending on the cleanup policy.</p>
</dd>
<dt class="hdlist1"><strong>Replicas</strong></dt>
<dd>
<p>For this release of Streams for Apache Kafka, the replicas are preconfigured. The number of partition replicas for the topic is set to <code>3</code> and the minimum number of follower replicas that must be in sync with a partition leader is set to <code>2</code>. Replicas are copies of partitions in a topic. Partition replicas are distributed over multiple brokers in the cluster to ensure topic availability if a broker fails. When a follower replica is in sync with a partition leader, the follower replica can become the new partition leader if needed.</p>
<div class="paragraph">
<p>After you complete the topic setup, the new Kafka topic is listed in the topics table.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="proc-binding-quarkus-applcation-to-kafka-instance-using-cli_service-binding">Binding the Quarkus application to your Kafka instance using the RHOAS CLI</h3>
<div class="paragraph _abstract">
<p>In this step of the tutorial, you use the RHOAS CLI to bind the example Quarkus application that you deployed on OpenShift to your Kafka instance. When you perform this binding, the Service Binding Operator injects connection parameters as files into the pod for the application. The Quarkus application automatically detects and uses the connection parameters to bind to the Kafka instance.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You understand how the Service Binding Operator injects connection parameters as files into the pod for a client application. See <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/service-binding-kafka/README.adoc#con-about-service-binding_service-binding">About service binding</a>.</p>
</li>
<li>
<p>The Service Binding Operator is installed on your OpenShift cluster.</p>
</li>
<li>
<p>The RHOAS Operator is installed on your OpenShift cluster and you have verified connection to the cluster.</p>
</li>
<li>
<p>You have connected a Kafka instance to a project in your OpenShift cluster.</p>
</li>
<li>
<p>You have deployed the example Quarkus application.</p>
</li>
<li>
<p>You have created the Kafka topic required by the Quarkus application.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>If you are not already logged in to the OpenShift CLI, log in using a token, as described in <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/service-binding-kafka/README.adoc#proc-verifying-connection-to-openshift-cluster_service-binding">Verifying connection to your OpenShift cluster</a>. Log in as the same user who verified connection to the cluster.</p>
</li>
<li>
<p>Log in to the RHOAS CLI.</p>
<div class="listingblock">
<div class="title">RHOAS CLI login command</div>
<div class="content">
<pre class="highlight"><code>$ rhoas login</code></pre>
</div>
</div>
</li>
<li>
<p>Use the OpenShift CLI to ensure that the current OpenShift project is the one that you previously connected your Kafka instance to, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example OpenShift CLI command to specify current OpenShift project</div>
<div class="content">
<pre class="highlight"><code>$ oc project my-project</code></pre>
</div>
</div>
</li>
<li>
<p>Use the RHOAS CLI to instruct the Service Binding Operator to bind your Kafka instance to an application in your OpenShift project.</p>
<div class="listingblock">
<div class="title">RHOAS CLI command to bind Kafka instance to application in OpenShift</div>
<div class="content">
<pre class="highlight"><code>$ rhoas cluster bind</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are prompted to specify the Kafka instance that you want to bind to an application in your OpenShift project.</p>
</div>
</li>
<li>
<p>If you have more than one Kafka instance, use the up and down arrows on your keyboard to highlight the instance that you want to bind to an application in OpenShift. Press <strong>Enter</strong>.</p>
<div class="paragraph">
<p>You are prompted to specify the application that you want to bind your Kafka instance to.</p>
</div>
</li>
<li>
<p>If you have more than one application in your OpenShift project, use the up and down arrows on your keyboard to highlight the <code>rhoas-quarkus-kafka</code> example application. Press <strong>Enter</strong>.</p>
</li>
<li>
<p>Type <code>y</code> to confirm that you want to continue. Press <strong>Enter</strong>.</p>
<div class="paragraph">
<p>When binding is complete, you should see output like the following:</p>
</div>
<div class="listingblock">
<div class="title">Example output from binding Kafka instance to application in OpenShift</div>
<div class="content">
<pre class="highlight"><code>Using Service Binding Operator to perform binding
Binding my-kafka-instance with rhoas-quarkus-kafka app succeeded</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output shows that the RHOAS CLI successfully instructed the Service Binding Operator to bind a Kafka instance called <code>my-kafka-instance</code> to the example Quarkus application called <code>rhoas-quarkus-kafka</code>. The Quarkus application automatically detected the connection parameters injected by the Service Binding Operator and used them to bind with the Kafka instance.</p>
</div>
<div class="paragraph">
<p>When service binding is complete, OpenShift redeploys the Quarkus application. When the application is running again, it starts to use the <code>prices</code> Kafka topic that you created in your Kafka instance. One part of the Quarkus application publishes price updates to this topic, while another part of the application consumes the updates.</p>
</div>
</li>
<li>
<p>To verify that the Quarkus application is using the Kafka topic, reopen the <strong>Last price</strong> web page that you opened earlier in this tutorial.</p>
<div class="paragraph">
<p>On the <strong>Last price</strong> web page, observe that the price value is continuously updated. The updates show that the Quarkus application is now using the <code>prices</code> topic in your Kafka instance to produce and consume messages that correspond to price updates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also use the OpenShift Streams for Apache Kafka web console to browse messages in the Kafka topic. For more information, see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/message-browsing-kafka/README.adoc" target="_blank" rel="noopener">Browsing messages in the OpenShift Streams for Apache Kafka web console</a>.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-binding-nodejs-application-using-web-console_service-binding">Binding a Node.js application to OpenShift Streams for Apache Kafka using the OpenShift web console</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>When the RHOAS Operator is installed on your OpenShift cluster and you have connected a Kafka instance to the cluster, you can use the OpenShift web console to instruct the Service Binding Operator to automatically inject an application running on the cluster with the parameters required to connect to the Kafka instance. This process is called <em>service binding</em>.</p>
</div>
<div class="paragraph">
<p>The following tutorial shows how to use the OpenShift web console to perform service binding. In the tutorial, you create an example Node.js application and connect this to a Kafka instance. <a href="https://nodejs.org/en/about/" target="_blank" rel="noopener">Node.js</a> is a server-side JavaScript runtime that&#8217;s designed to build scalable network applications. Node.js provides an I/O model based on events and non-blocking operations, which enables efficient applications.</p>
</div>
<div class="paragraph">
<p>When you perform service binding, the Service Binding Operator automatically injects connection parameters as files into the pod for the application. The example Node.js application in this tutorial uses the <code>kube-service-bindings</code> <a href="https://www.npmjs.com/package/kube-service-bindings" target="_blank" rel="noopener">package</a>. This means that the application automatically detects the injected connection parameters and converts the information into the format used by two popular Node.js clients; <a href="https://kafka.js.org/" target="_blank" rel="noopener">KafkaJS</a> and <a href="https://github.com/blizzard/node-rdkafka" target="_blank" rel="noopener">node-rdkafka</a>.</p>
</div>
<div class="paragraph">
<p>In general, this automatic injection and detection of connection parameters eliminates the need to manually configure an application to connect to a Kafka instance in OpenShift Streams for Apache Kafka. This is a particular advantage if you have many applications in your project that you want to connect to a Kafka instance.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites_2">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>Your OpenShift cluster is running on OpenShift 4.8 or later.</p>
</li>
<li>
<p>The Service Binding Operator is installed on your OpenShift cluster.</p>
</li>
<li>
<p>The RHOAS Operator is installed on your OpenShift cluster and you have verified connection to the cluster.</p>
</li>
<li>
<p>You have connected a Kafka instance to a project in your OpenShift cluster.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="proc-deploying-example-nodejs-application-on-openshift_service-binding">Deploying an example Node.js application on OpenShift</h3>
<div class="paragraph _abstract">
<p>In this step of the tutorial, you deploy an example Node.js application in the OpenShift project that you previously connected your Kafka instance to.</p>
</div>
<div class="paragraph">
<p>To deploy the example application, you use sample code from the Nodeshift Application Starters <a href="https://github.com/nodeshift-starters/reactive-example" target="_blank" rel="noopener">reactive example</a> repository in GitHub. In particular, you install the following components of the Node.js application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>producer-backend</code> component that generates random country names and sends these names to a topic in your Kafka instance.</p>
</li>
<li>
<p>A <code>consumer-backend</code> component that consumes the country names from the Kafka topic.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have privileges to deploy applications in the OpenShift project that you connected your Kafka instance to.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the OpenShift web console with privileges to deploy applications in the project that you previously connected your Kafka instance to.</p>
</li>
<li>
<p>Click the perspective switcher in the upper-left corner. Switch to the <strong>Developer</strong> perspective.</p>
<div class="paragraph">
<p>The <strong>Topology</strong> page opens.</p>
</div>
</li>
<li>
<p>Ensure that the current OpenShift project is the one you previously connected your Kafka instance to.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>At the top of the <strong>Topology</strong> page, click the <strong>Project</strong> list.</p>
</li>
<li>
<p>Select the project that you previously connected your Kafka instance to.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If you are not already logged in to the OpenShift CLI, log in using a token, as described in <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/service-binding-kafka/README.adoc#proc-verifying-connection-to-openshift-cluster_service-binding">Verifying connection to your OpenShift cluster</a>. Log in as the same user who verified connection to the cluster.</p>
</li>
<li>
<p>On the command line, clone the Nodeshift Application Starters <a href="https://github.com/nodeshift-starters/reactive-example" target="_blank" rel="noopener">reactive-example</a> repository from GitHub.</p>
<div class="listingblock">
<div class="title">Git command to clone reactive-example repository</div>
<div class="content">
<pre class="highlight"><code>$ git clone https://github.com/nodeshift-starters/reactive-example.git</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>reactive-example</code> directory of the repository that you cloned.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd reactive-example</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the directory for the consumer component. Use Node Package Manager (npm) to install the dependencies for this component.</p>
<div class="listingblock">
<div class="title">Installation of dependencies for consumer component</div>
<div class="content">
<pre class="highlight"><code>$ cd consumer-backend
$ npm install</code></pre>
</div>
</div>
</li>
<li>
<p>Build the consumer component and deploy it to your OpenShift project.</p>
<div class="listingblock">
<div class="title">Deployment of consumer component to OpenShift</div>
<div class="content">
<pre class="highlight"><code>$ npm run openshift</code></pre>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, ensure that you are on the <strong>Topology</strong> page.</p>
<div class="paragraph">
<p>You should see an icon for the consumer component that you deployed. The component is a <code>DeploymentConfig</code> object and is labelled <code>DC</code>. After some time, OpenShift completes the deployment.</p>
</div>
</li>
<li>
<p>Click the icon for the consumer component.</p>
<div class="paragraph">
<p>A sidebar opens with the <strong>Resources</strong> tab displayed. Under <strong>Pods</strong>, you should see a single pod.</p>
</div>
</li>
<li>
<p>Next to the name of the pod, click <strong>View logs</strong>.</p>
<div class="paragraph">
<p>In the logs of the pod for the consumer component, you should see errors indicating that the component can&#8217;t connect to Kafka. You will establish this connection later in this tutorial.</p>
</div>
</li>
<li>
<p>On the command line, in the repository that you cloned, navigate to the directory for the producer component. Use Node Package Manager to install the dependencies for this component.</p>
<div class="listingblock">
<div class="title">Installation of dependencies for producer component</div>
<div class="content">
<pre class="highlight"><code>$ cd ..
$ cd producer-backend
$ npm install</code></pre>
</div>
</div>
</li>
<li>
<p>Build the producer component and deploy it to your OpenShift project.</p>
<div class="listingblock">
<div class="title">Deployment of producer component to OpenShift</div>
<div class="content">
<pre class="highlight"><code>$ npm run openshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the <strong>Topology</strong> page of the OpenShift web console, you should see an icon for the producer component that you deployed. The producer component is also a <code>DeploymentConfig</code> object and labelled <code>DC</code>. After some time, OpenShift completes the deployment.</p>
</div>
</li>
<li>
<p>Open the logs of the pod for the producer component, in the same way that you did for the consumer component.</p>
<div class="paragraph">
<p>In the logs, you should see errors indicating that the producer component can&#8217;t connect to Kafka. You will also establish this connection later in this tutorial.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-creating-countries-topic-in-kafka-instance_service-binding">Creating the countries topic in your Kafka instance</h3>
<div class="paragraph _abstract">
<p>In the previous step of this tutorial, you deployed an example application on OpenShift. The application is a Node.js application that uses a Kafka topic called <code>countries</code> to produce and consume messages. In this step, you will create the <code>countries</code> topic in your Kafka instance.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have deployed the example Node.js application.</p>
</li>
<li>
<p>You have a running Kafka instance in Streams for Apache Kafka (see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/getting-started-kafka/README.adoc" target="_blank" rel="noopener">Getting started with OpenShift Streams for Apache Kafka</a>).</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the <a href="https://console.redhat.com/application-services/streams/" target="_blank" rel="noopener">Kafka Instances</a> page of the Streams for Apache Kafka web console, click the name of the Kafka instance that you want to add a topic to.</p>
</li>
<li>
<p>Select the <strong>Topics</strong> tab and click <strong>Create topic</strong>. On the topic creation page shown in the figure, follow the guided steps to define the details of the <code>countries</code> topic. Click <strong>Next</strong> to complete each step and click <strong>Finish</strong> to complete the setup.</p>
<div class="imageblock">
<div class="content">
<img src="./images/sak-create-countries-topic.png" alt="Image of wizard to create countries topic">
</div>
<div class="title">Figure 2. Guided steps to define topic</div>
</div>
<div class="paragraph">
<p>The following list describes the topic properties that you must specify.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Topic name</strong></dt>
<dd>
<p>Enter <code>countries</code> as the topic name.</p>
</dd>
<dt class="hdlist1"><strong>Partitions</strong></dt>
<dd>
<p>Set the number of partitions for this topic. For this tutorial, set a value of <code>1</code>. Partitions are distinct lists of messages within a topic and enable parts of a topic to be distributed over multiple brokers in the cluster. A topic can contain one or more partitions, enabling producer and consumer loads to be scaled.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can increase the number of partitions later, but you cannot decrease them.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><strong>Message retention</strong></dt>
<dd>
<p>Set the message retention time to the relevant value and increment. For this tutorial, set a value of <code>A week</code>. Message retention time is the amount of time that messages are retained in a topic before they are deleted or compacted, depending on the cleanup policy.</p>
</dd>
<dt class="hdlist1"><strong>Replicas</strong></dt>
<dd>
<p>For this release of Streams for Apache Kafka, the replicas are preconfigured. The number of partition replicas for the topic is set to <code>3</code> and the minimum number of follower replicas that must be in sync with a partition leader is set to <code>2</code>. Replicas are copies of partitions in a topic. Partition replicas are distributed over multiple brokers in the cluster to ensure topic availability if a broker fails. When a follower replica is in sync with a partition leader, the follower replica can become the new partition leader if needed.</p>
<div class="paragraph">
<p>After you complete the topic setup, the new Kafka topic is listed in the topics table.</p>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-binding-nodejs-application-to-kafka-instance-using-web-console_service-binding">Binding the Node.js application to your Kafka instance using the OpenShift web console</h3>
<div class="paragraph _abstract">
<p>In this step of the tutorial, you use the OpenShift web console to bind the components of the example Node.js application that you deployed on OpenShift to your Kafka instance. When you perform this binding, the Service Binding Operator injects connection parameters as files into the pod for each component.</p>
</div>
<div class="paragraph">
<p>The example Node.js application uses the <code>kube-service-bindings</code> <a href="https://www.npmjs.com/package/kube-service-bindings" target="_blank" rel="noopener">package</a>. This means that the application automatically detects and uses the injected connection parameters.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You understand how the Service Binding Operator injects connection parameters as files into the pod for a client application. See <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/service-binding-kafka/README.adoc#con-about-service-binding_service-binding">About service binding</a>.</p>
</li>
<li>
<p>The Service Binding Operator is installed on your OpenShift cluster.</p>
</li>
<li>
<p>The RHOAS Operator is installed on your OpenShift cluster and you have verified connection to the cluster.</p>
</li>
<li>
<p>You have connected a Kafka instance to a project in your OpenShift cluster.</p>
</li>
<li>
<p>You have deployed the example Node.js application.</p>
</li>
<li>
<p>You have created the Kafka topic required by the Node.js application.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Ensure that you are logged in to the OpenShift web console as the same user who deployed the Node.js application earlier in this tutorial.</p>
</li>
<li>
<p>Click the perspective switcher in the upper-left corner. Switch to the <strong>Developer</strong> perspective.</p>
<div class="paragraph">
<p>The <strong>Topology</strong> page opens.</p>
</div>
</li>
<li>
<p>Ensure that the current OpenShift project is the one you previously connected your Kafka instance to.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>At the top of the <strong>Topology</strong> page, click the <strong>Project</strong> list.</p>
</li>
<li>
<p>Select the project that you previously connected your Kafka instance to.</p>
<div class="paragraph">
<p>On the <strong>Topology</strong> page for your project, you should see an icon for the <code>KafkaConnection</code> object that was created when you connected a Kafka instance to the project. The icon for the <code>KafkaConnection</code> object is labelled <code>AKC</code>. The name of the object matches the name of the Kafka instance that you connected to the project.</p>
</div>
<div class="paragraph">
<p>You should also see icons for the producer and consumer components of the Node.js application that you deployed. Each component is a <code>DeploymentConfig</code> object and is labelled <code>DC</code>.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>To start creating a service binding connection, hover the mouse pointer over the icon for the consumer component, as shown in the figure.</p>
<div class="imageblock">
<div class="content">
<img src="./images/sak-service-binding-arrow.png" alt="Image of arrow to create a binding connection">
</div>
<div class="title">Figure 3. Action to start service binding connection</div>
</div>
<div class="paragraph">
<p>An arrow with a dotted line appears from the icon.</p>
</div>
</li>
<li>
<p>Left-click and drag the head of the arrow until it&#8217;s directly over the icon for the <code>KafkaConnection</code> object, as shown in the figure.</p>
<div class="imageblock">
<div class="content">
<img src="./images/sak-service-binding-tooltip.png" alt="Image of service binding tooltip">
</div>
<div class="title">Figure 4. Tooltip indicating type of connection to be created</div>
</div>
<div class="paragraph">
<p>A tooltip appears over the icon for the <code>KafkaConnection</code> object. The tooltip indicates that you are about to create a service binding connection.</p>
</div>
</li>
<li>
<p>To create the service binding connection, release the left mouse button, as shown in the figure.</p>
<div class="imageblock">
<div class="content">
<img src="./images/sak-service-binding-connection.png" alt="Image of completed binding connection">
</div>
<div class="title">Figure 5. Completed service binding connection</div>
</div>
<div class="paragraph">
<p>When you create the binding connection, the Service Binding Operator injects connection parameters as files into the pod for the consumer component. The <code>kube-service-bindings</code> <a href="https://www.npmjs.com/package/kube-service-bindings" target="_blank" rel="noopener">package</a> used by the consumer component automatically detects these files and converts the information into the format required by the KafkaJS client that the component uses by default.</p>
</div>
</li>
<li>
<p>To bind the producer component to the <code>KafkaConnection</code> object, drag a connection to the <code>KafkaConnection</code> object, in the same way that you did for the consumer component.</p>
</li>
<li>
<p>When you have made a connection to the <code>KafkaConnection</code> object, click the icon for the producer component.</p>
<div class="paragraph">
<p>A sidebar opens with the <strong>Resources</strong> tab displayed. Under <strong>Pods</strong>, you still see a single pod corresponding to the component.</p>
</div>
</li>
<li>
<p>Next to the name of the pod, click <strong>View logs</strong>.</p>
<div class="paragraph">
<p>You should now see that the producer has connected to the Kafka instance. The producer generates random country names and sends these as messages to the <code>countries</code> Kafka topic that you created.</p>
</div>
</li>
<li>
<p>Open the logs for the pod of the consumer component, in the same way that you did for the producer component.</p>
<div class="paragraph">
<p>You should now see that the consumer has connected to the Kafka instance. The consumer displays the same country names that the producer sends to the <code>countries</code> Kafka topic, and in the same order.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also use the OpenShift Streams for Apache Kafka web console to browse messages in the Kafka topic. For more information, see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/message-browsing-kafka/README.adoc" target="_blank" rel="noopener">Browsing messages in the OpenShift Streams for Apache Kafka web console</a>.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-03-01 21:27:08 UTC
</div>
</div>
</body>
</html>