<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Connecting client applications to OpenShift Application Services using the rhoas CLI</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body id="chap-connecting-client-applications-rhoas-cli" class="article">
<div id="header">
<h1>Connecting client applications to OpenShift Application Services using the rhoas CLI</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a developer of applications and services, you might need to connect client applications to instances in cloud services such as OpenShift Streams for Apache Kafka and OpenShift Service Registry.</p>
</div>
<div class="paragraph">
<p>For example, suppose you have the following applications running locally on your computer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One application that is designed to publish a stream of stock price updates</p>
</li>
<li>
<p>A second application that is designed to consume the stock price updates and chart them on a dashboard</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, suppose you have the following instances in OpenShift Application Services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Kafka instance in Streams for Apache Kafka</p>
</li>
<li>
<p>A Service Registry instance in Service Registry</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each time the first application produces a stock price update, you want to use the Kafka instance to forward the update as an event to the second, consuming application. In addition, you want each of the applications to use a schema in the Service Registry instance to validate that messages conform to a particular format.</p>
</div>
<div class="paragraph">
<p>In this scenario, you need to connect your applications to your Kafka and Service Registry instances. To achieve this, you can use the OpenShift Application Services (<code>rhoas</code>) command-line interface (CLI) to create a <em>context</em> for your service instances. You can then use another CLI command to generate the required connection information for each service instance in the context.</p>
</div>
<div class="paragraph">
<p>This guide describes how to use the <code>rhoas</code> CLI to create contexts and then generate the connection configuration information that client applications need to connect to service instances in those contexts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-about-service-contexts_connecting-client-applications-rhoas-cli">About service contexts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In OpenShift Application Services, a service context is a defined set of instances running in cloud services such as OpenShift Streams for Apache Kafka and OpenShift Service Registry. You might create different contexts for specific use cases, projects, or environments.</p>
</div>
<div class="paragraph">
<p>To create a context, you can use the OpenShift Application Services (<code>rhoas</code>) command-line interface (CLI). New service instances that you create are automatically added to the context that is currently in use. You can switch between different contexts and add or remove service instances as required. You can include the same service instance in multiple contexts.</p>
</div>
<div class="paragraph">
<p>When you have created a service context, you can use a single CLI command to generate the configuration information that client applications need to connect to the instances in that context. You can generate connection configuration information in various formats such as an environment variables file (.env), a JSON file, a Java properties file, and a Kubernetes ConfigMap.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-creating-new-service-contexts_connecting-client-applications-rhoas-cli">Creating new service contexts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example shows how to use the CLI to create contexts in OpenShift Application Services and then manage the service instances that are defined in those contexts.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the OpenShift Application Services (<code>rhoas</code>) CLI. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_application_services/1/guide/bb30ee92-9e0a-4fd6-a67f-aed8910d7da3#proc-installing-rhoas_installing-rhoas-cli" target="_blank" rel="noopener">Installing the rhoas CLI</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the CLI.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas login</code></pre>
</div>
</div>
<div class="paragraph">
<p>The login command opens a sign-in process in your web browser.</p>
</div>
</li>
<li>
<p>Use the CLI to create a new service context.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context create --name development-context</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new context becomes the <em>current</em> (that is, active) context by default.</p>
</div>
</li>
<li>
<p>Create a new Kafka instance in OpenShift Streams for Apache Kafka.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas kafka create --name my-kafka-instance</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CLI automatically adds the Kafka instance to the current context.</p>
</div>
</li>
<li>
<p>Create a new Service Registry instance in OpenShift Service Registry.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas service-registry create --name my-registry-instance</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CLI also automatically adds the Service Registry instance to the current context.</p>
</div>
</li>
<li>
<p>Confirm that the Kafka and Service Registry instances are in the current context and are running.</p>
<div class="listingblock">
<div class="title">Command to view status of service instances in current context</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context status</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see output that looks like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Status of example context with single Kafka and Service Registry instances</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-shell" data-lang="shell">Service Context Name:	development-context
Context File Location:	/home/<em>&lt;user-name&gt;</em>/.config/rhoas/contexts.json

Kafka
-----------------------------------------------------------------------------
ID:                cafkr2jma40lhulbl1c0
Name:              my-kafka-instance
Status:            ready
Bootstrap URL:     kafka-inst-cafkr-jma--lhulbl-ca.bf2.kafka.rhcloud.com:443

Service Registry
------------------------------------------------------------------------------
ID:                0aa1dd8b-63d5-466c-9de8-7c03320a81c2
Name:              my-registry-instance
Status:            ready
Registry URL:      https://bu98.serviceregistry.rhcloud.com/t/0aa1dd8b-63d5-466c-9de8-7c03320a81c2</code></pre>
</div>
</div>
</li>
<li>
<p>Create another service context.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context create --name production-context</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new service context becomes the current context.</p>
</div>
</li>
<li>
<p>Add the Kafka instance that you created earlier in the procedure to the new service context.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context set-kafka --name my-kafka-instance</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kafka instance is now part of both of the service contexts that you created.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To remove a particular service from a context, use the <code>context unset</code> command with the <code>--services</code> flag and specify the service name, for example, <code>kafka</code> or <code>service-registry</code>. An example is shown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context unset --name development-context --services kafka</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>To learn more about the <code>context</code> commands that you can use to manage service contexts, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_application_services/1/guide/8bd088a6-b7b7-4e5d-832a-b0f0494f9070" target="_blank" rel="noopener">CLI command reference (rhoas)</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-generating-connection-information-quarkus_connecting-client-applications-rhoas-cli">Generating connection configuration information for a local Quarkus application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example shows how to connect an example Quarkus application running locally on your computer to the service instances defined in a context in OpenShift Application Services. <a href="https://quarkus.io/" target="_blank" rel="noopener">Quarkus</a> is a Kubernetes-native Java framework that is optimized for serverless, cloud, and Kubernetes environments.</p>
</div>
<div class="paragraph">
<p>The Quarkus application uses a topic in a Kafka instance to produce and consume a stream of quote values and display these on a web page. The application consists of two components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A producer component that periodically produces a new quote value and publishes this to a Kafka topic called <code>quotes</code>.</p>
</li>
<li>
<p>A consumer component that streams quote values from the Kafka topic. This component also has a minimal front end that uses server-sent events to show the quote values on a web page.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the producer and consumer components serialize and deserialize Kafka messages using an Avro schema stored in Service Registry. Use of the schema ensures that message values conform to a defined format.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a service context with a Kafka and Service Registry instance.</p>
</li>
<li>
<p><a href="https://github.com/git-guides/" target="_blank" rel="noopener">Git</a> is installed.</p>
</li>
<li>
<p>You have an IDE such as <a href="https://www.jetbrains.com/idea/download/" target="_blank" rel="noopener">IntelliJ IDEA</a>, <a href="https://www.eclipse.org/downloads/" target="_blank" rel="noopener">Eclipse</a>, or <a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener">Visual Studio Code</a>.</p>
</li>
<li>
<p><a href="https://adoptopenjdk.net/" target="_blank" rel="noopener">OpenJDK</a> 11 or later is installed. (The latest LTS version of OpenJDK is recommended.)</p>
</li>
<li>
<p><a href="https://maven.apache.org/" target="_blank" rel="noopener">Apache Maven</a> 3.8 (or a later Maven 3 release) is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the command line, clone the OpenShift Application Services <a href="https://github.com/redhat-developer/app-services-guides" target="_blank" rel="noopener">Guides and Samples</a> repository from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ git clone https://github.com/redhat-developer/app-services-guides app-services-guides</code></pre>
</div>
</div>
</li>
<li>
<p>In your IDE, open the <code>code-examples/quarkus-service-registry-quickstart</code> directory from the repository that you cloned.</p>
<div class="paragraph">
<p>You see that the sample Quarkus application has two components - a producer component and a consumer component. The producer component publishes a stream of quote values to a Kafka topic. The consumer component consumes these values and displays them on a web page.</p>
</div>
</li>
<li>
<p>On the command line, create the <code>quotes</code> topic required by the Quarkus application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas kafka topic create --name quotes</code></pre>
</div>
</div>
</li>
<li>
<p>Ensure that you are using the service context that includes your Kafka and Service Registry instances, as shown in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context use --name development-context</code></pre>
</div>
</div>
</li>
<li>
<p>In the guides and samples repository that you cloned, navigate to the directory for the Quarkus application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ cd ~/app-services-guides/code-examples/quarkus-service-registry-quickstart/</code></pre>
</div>
</div>
</li>
<li>
<p>Create a service account for the Quarkus application to authenticate with the Kafka and Service Registry instances in the context. Save the credentials in an environment variables file in the directory for the producer component.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas service-account create --file-format env --output-file ./producer/.env</code></pre>
</div>
</div>
</li>
<li>
<p>Generate an environment variables file that contains the connection configuration information required by the producer component.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas generate-config --type env --output-file ./producer/rhoas.env</code></pre>
</div>
</div>
</li>
<li>
<p>Append the contents of the connection configuration file to the service account environment variables file.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ cat ./producer/rhoas.env &gt;&gt; ./producer/.env</code></pre>
</div>
</div>
</li>
<li>
<p>Copy the updated <code>.env</code> file to the directory for the consumer component, as shown in the following Linux example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ cp ./producer/.env ./consumer/.env</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a service context with single Kafka and Service Registry instances, the <code>.env</code> file looks like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example environment variables file for connection configuration and credentials</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">## Generated by rhoas cli
RHOAS_SERVICE_ACCOUNT_CLIENT_ID=<em>&lt;client-id&gt;</em>
RHOAS_SERVICE_ACCOUNT_CLIENT_SECRET=<em>&lt;client-secret&gt;</em>
RHOAS_SERVICE_ACCOUNT_OAUTH_TOKEN_URL=https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token
## Generated by rhoas cli
## Kafka Configuration
KAFKA_HOST=kafka-inst-cafkr-jma--lhulbl-ca.bf2.kafka.rhcloud.com:443
## Service Registry Configuration
SERVICE_REGISTRY_URL=https://bu98.serviceregistry.rhcloud.com/t/0aa1dd8b-63d5-466c-9de8-7c03320a81c2
SERVICE_REGISTRY_CORE_PATH=/apis/registry/v2
SERVICE_REGISTRY_COMPAT_PATH=/apis/ccompat/v6</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the example, the file that you generate contains the endpoints for your service instances, and the credentials required to connect to those instances.</p>
</div>
</li>
<li>
<p>Set Access Control List (ACL) permissions to enable the new service account to access resources in the Kafka instance.</p>
<div class="listingblock">
<div class="title">Example command for granting access to Kafka instance</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas kafka acl grant-access --producer --consumer --service-account <em>&lt;client-id&gt;</em> --topic quotes --group all</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command you entered allows applications to use the service account to produce and consume messages in the <code>quotes</code> topic. Applications can use any consumer group.</p>
</div>
</li>
<li>
<p>Use Role-Based Access Control (RBAC) to enable the new service account to access the Service Registry instance and the artifacts (such as schemas) that it contains.</p>
<div class="listingblock">
<div class="title">Example command for granting access to Service Registry instance</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas service-registry role add --role manager --service-account <em>&lt;client-id&gt;</em></code></pre>
</div>
</div>
</li>
<li>
<p>In the guides and samples repository, navigate to the directory for the producer component. Use Apache Maven to run the producer component in developer mode.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-shell" data-lang="shell">$ cd ~/app-services-guides/code-examples/quarkus-service-registry-quickstart/producer
$ mvn quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The producer component starts to generate quote values to the <code>quotes</code> topic in the Kafka instance.</p>
</div>
<div class="paragraph">
<p>The Quarkus application also created an Avro schema called <code>quotes-value</code> in the Service Registry instance. The producer and consumer components use the schema to ensure that message values conform to a defined format.</p>
</div>
<div class="paragraph">
<p>To view the contents of the <code>quotes-value</code> schema, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas service-registry artifact get --artifact-id quotes-value</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see output that looks like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example Avro schema in Service Registry</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">{
  "type": "record",
  "name": "Quote",
  "namespace": "org.acme.kafka.quarkus",
  "fields": [
    {
      "name": "id",
      "type": {
        "type": "string",
        "avro.java.string": "String"
      }
    },
    {
      "name": "price",
      "type": "int"
    }
  ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>With the producer component still running, open a second command-line window or tab. In the guides and samples repository, navigate to the directory for the consumer component and run the component in developer mode.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-shell" data-lang="shell">$ cd ~/app-services-guides/code-examples/quarkus-service-registry-quickstart/consumer
$ mvn quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The consumer component starts to consume the stream of quote values from the <code>quotes</code> topic.</p>
</div>
</li>
<li>
<p>In a web browser, go to  <a href="http://localhost:8080/quotes.html" class="bare" target="_blank" rel="noopener">http://localhost:8080/quotes.html</a>.</p>
<div class="paragraph">
<p>You see that the consumer component displays the stream of quote values on the web page. This output shows that the Quarkus application used the connection configuration information that you generated to connect to the Kafka and Service Registry instances in your service context.</p>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_application_services/1/guide/8bd088a6-b7b7-4e5d-832a-b0f0494f9070#_b7f033ec-6f0c-4b3c-89b0-cb1801de19f9" target="_blank" rel="noopener">CLI command reference (rhoas)</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_streams_for_apache_kafka/1/guide/2f4bf7cf-5de2-4254-8274-6bf71673f407" target="_blank" rel="noopener"> Managing account access in OpenShift Streams for Apache Kafka</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_service_registry/1/guide/7717db0b-9fad-4fff-91b7-b311b63290a4" target="_blank" rel="noopener">Managing account access in OpenShift Service Registry</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-generating-connection-information-helm_connecting-client-applications-rhoas-cli">Generating connection configuration information for a Helm-based OpenShift application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example shows how to use Helm to deploy an example Quarkus application on Kubernetes and then connect the Quarkus application to a Kafka instance in OpenShift Streams for Apache Kafka. <a href="https://helm.sh/" target="_blank" rel="noopener">Helm</a> is an open source utility for creating, configuring, and deploying applications on Kubernetes. The Kubernetes platform referred to in the remainder of this example is Red Hat OpenShift.</p>
</div>
<div class="paragraph">
<p>One part of the example Quarkus application is designed to generate random price values and produce these to a Kafka topic. Another part of the application consumes the numbers from the Kafka topic. The application uses server-sent events to expose the values as a REST UI. Finally, a web page in the application displays the exposed values.</p>
</div>
<div class="paragraph">
<p>To connect the Quarkus application to a Kafka instance in Streams for Apache Kafka, you define a service context that includes the Kafka instance. You then generate connection configuration information for the service context as an OpenShift ConfigMap object and provide this to the application.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a running Kafka instance in Streams for Apache Kafka.</p>
</li>
<li>
<p>You have created a service context for your Kafka instance.</p>
</li>
<li>
<p>You have installed the latest version of the <code>rhoas</code> command-line interface (CLI). See <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/rhoas/rhoas-cli-installation/README.adoc" target="_blank" rel="noopener">Installing and configuring the rhoas CLI</a>.</p>
</li>
<li>
<p>You have installed version 3.9.0 or greater of the <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener">Helm CLI</a>.</p>
</li>
<li>
<p>You have installed version 4.8.5 or greater of the <a href="https://docs.openshift.com/container-platform/4.11/cli_reference/openshift_cli/getting-started-cli.html" target="_blank" rel="noopener">OpenShift CLI</a>.</p>
</li>
<li>
<p><a href="https://github.com/git-guides/" target="_blank" rel="noopener">Git</a> is installed.</p>
</li>
<li>
<p>You have an IDE such as <a href="https://www.jetbrains.com/idea/download/" target="_blank" rel="noopener">IntelliJ IDEA</a>, <a href="https://www.eclipse.org/downloads/" target="_blank" rel="noopener">Eclipse</a>, or <a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener">Visual Studio Code</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the command line, clone the OpenShift Application Services <a href="https://github.com/redhat-developer/app-services-guides" target="_blank" rel="noopener">Guides and Samples</a> repository in GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-shell" data-lang="shell">git clone https://github.com/redhat-developer/app-services-guides app-services-guides</code></pre>
</div>
</div>
</li>
<li>
<p>Log in to the rhoas CLI.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas login</code></pre>
</div>
</div>
<div class="paragraph">
<p>The login command opens a sign-in process in your web browser.</p>
</div>
</li>
<li>
<p>Check the service context that is currently in use.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CLI shows a check mark next to the service context that is currently in use.</p>
</div>
</li>
<li>
<p>(Optional) To switch to a different service context that includes your Kafka instance, use the following command. Replace <code><em>&lt;service-context&gt;</em></code> with your service context name.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas context use --name <em>&lt;service-context&gt;</em></code></pre>
</div>
</div>
</li>
<li>
<p>Generate connection configuration information for the service context as an OpenShift <code>ConfigMap</code> and save this in a YAML file, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Generating ConfigMap from service context</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas generate-config --type configmap --output-file ./rhoas-services.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a service context with a single Kafka instance, the contents of the <code>ConfigMap</code> file look like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example ConfigMap file generated from service context</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
    name: <em>&lt;service-context&gt;</em>-configuration
data:
    ## Kafka Configuration
    kafka_host: <em>&lt;host&gt;</em>:<em>&lt;port&gt;</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>As indicated in the example, the name of the generated <code>ConfigMap</code> object has a format of <code><em>&lt;service-context&gt;</em>-configuration</code>.</p>
</div>
</li>
<li>
<p>On the command line, create the <code>prices</code> topic required by the Quarkus application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas kafka topic create --name prices</code></pre>
</div>
</div>
</li>
<li>
<p>Create a service account for the Quarkus application to authenticate with your Kafka instance by performing the following actions.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create a new service account as an OpenShift secret and save this in a YAML file, as shown in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas service-account create --file-format secret --output-file ./rhoas-secrets.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Open the YAML file for the secret in your IDE.</p>
<div class="paragraph">
<p>The contents of the file look like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example secret file for service account credentials</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: service-account-credentials
type: Opaque
stringData:
  RHOAS_SERVICE_ACCOUNT_CLIENT_ID: <em>&lt;client-id&gt;</em>
  RHOAS_SERVICE_ACCOUNT_CLIENT_SECRET: <em>&lt;client-secret&gt;</em>
  RHOAS_SERVICE_ACCOUNT_OAUTH_TOKEN_URL: <em>&lt;oauth-token-endpoint-uri&gt;</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>As indicated in the example, the generated secret has a default name of <code>service-account-credentials</code>.</p>
</div>
</li>
<li>
<p>Set Access Control List (ACL) permissions to enable the new service account to access resources in the Kafka instance.</p>
<div class="listingblock">
<div class="title">Example command for granting access to Kafka instance</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ rhoas kafka acl grant-access --producer --consumer --service-account <em>&lt;client-id&gt;</em> --topic prices --group all</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command you entered allows applications to use the service account to produce and consume messages in the <code>prices</code> topic. Applications can use any consumer group.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Log in to the OpenShift CLI using a token by performing the following actions.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the OpenShift web console as a user who has privileges to create a new project in the cluster.</p>
</li>
<li>
<p>In the upper-right corner of the console, click your user name and select <strong>Copy login command</strong>.</p>
<div class="paragraph">
<p>A new page opens.</p>
</div>
</li>
<li>
<p>Click the <strong>Display Token</strong> link.</p>
</li>
<li>
<p>In the <strong>Log in with this token</strong> section, copy the full <code>oc login</code> command shown.</p>
</li>
<li>
<p>On the command line, right-click and select <strong>Paste</strong>.</p>
<div class="paragraph">
<p>You see output confirming that you are logged in to your OpenShift cluster and the current project that you are using. By default, this is the project in which you will deploy the Quarkus application.</p>
</div>
</li>
<li>
<p>(Optional) To change to another, existing project, use the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ oc project <em>&lt;project&gt;</em></code></pre>
</div>
</div>
</li>
<li>
<p>(Optional) To create a <em>new</em> project in which to deploy the Quarkus application, use the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ oc new-project <em>&lt;project&gt;</em></code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Use the OpenShift CLI to apply the <code>ConfigMap</code> and secret files to the current project in your OpenShift cluster.</p>
<div class="listingblock">
<div class="title">Applying ConfigMap and secret files to OpenShift project</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ oc apply -f ./rhoas-services.yaml
$ oc apply -f ./rhoas-secrets.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you apply the YAML files, the OpenShift CLI shows the names of the <code>ConfigMap</code> and <code>Secret</code> objects that it creates in your OpenShift project, as shown in the following example output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">configmap/my-service-context-configuration created
secret/service-account-credentials created</code></pre>
</div>
</div>
</li>
<li>
<p>In your IDE, open the <code>deployment.yaml</code> file in the <code>code-examples/helm-kafka-example/templates</code> directory of the repository that you cloned.</p>
<div class="paragraph">
<p>The <code>deployment.yaml</code> file is a template file that is part of the Helm chart for the example Quarkus application. The template defines environment variables for the connection information required to connect to your Kafka instance. The environment variables (<code>KAFKA_HOST</code>,<code>RHOAS_SERVICE_ACCOUNT_OAUTH_TOKEN_URL</code>, <code>RHOAS_SERVICE_ACCOUNT_CLIENT_ID</code>, and <code>RHOAS_SERVICE_ACCOUNT_CLIENT_SECRET</code>) are shown in the following sample from the template file:</p>
</div>
<div class="listingblock">
<div class="title">Example Helm template file for application deployment</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  containers:
    - env:
        - name: KAFKA_HOST
          valueFrom:
            configMapKeyRef:
              name: {{ .Values.rhoas.config }}
              key: kafka_host
        - name: RHOAS_SERVICE_ACCOUNT_OAUTH_TOKEN_URL
          valueFrom:
            secretKeyRef:
              name:  {{ .Values.rhoas.secret }}
              key: RHOAS_SERVICE_ACCOUNT_OAUTH_TOKEN_URL
        - name: RHOAS_SERVICE_ACCOUNT_CLIENT_ID
          valueFrom:
            secretKeyRef:
              name:  {{ .Values.rhoas.secret }}
              key: RHOAS_SERVICE_ACCOUNT_CLIENT_ID
        - name: RHOAS_SERVICE_ACCOUNT_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              name:  {{ .Values.rhoas.secret }}
              key: RHOAS_SERVICE_ACCOUNT_CLIENT_SECRET</code></pre>
</div>
</div>
<div class="paragraph">
<p>The template uses parameters called <code>rhoas.config</code> and <code>rhoas.secret</code> to reference the names of your <code>ConfigMap</code> and <code>Secret</code> objects. You specify the names of your <code>ConfigMap</code> and <code>Secret</code> objects as values for these parameters in a later step, when you install the Helm chart. Also, as you saw previously, the <code>ConfigMap</code> and <code>Secret</code> objects that you created contain parameters that correspond directly to the key values defined in the template.</p>
</div>
</li>
<li>
<p>On the command line, navigate to the <code>code-examples/helm-kafka-example</code> directory of the repository that you cloned.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ cd app-services-guides/code-examples/helm-kafka-example</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy the Helm chart, specifying the names of the <code>ConfigMap</code> and <code>Secret</code> objects that you created in your OpenShift project.</p>
<div class="listingblock">
<div class="title">Deploying the Helm chart</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-shell" data-lang="shell">$ helm install . --generate-name --set-string rhoas.config=<em>&lt;configmap&gt;</em>,rhoas.secret=service-account-credentials</code></pre>
</div>
</div>
<div class="paragraph">
<p>You use the <code>--set-string</code> option to specify the names of the <code>ConfigMap</code> and <code>Secret</code> objects directly in the <code>helm install</code> command. You pass these values to the <code>rhoas.config</code> and <code>rhoas.secret</code> parameters that are defined in the template for the Helm chart.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An alternative way to pass values from the <code>ConfigMap</code> and <code>Secret</code> objects to the Helm template is to create a YAML file that contains the names of the <code>ConfigMap</code> and <code>Secret</code> objects. This approach also works for Deployment-based OpenShift applications. For an example of doing this, see the <a href="https://github.com/redhat-developer/app-services-guides/blob/main/code-examples/helm-kafka-example/README.md" target="_blank" rel="noopener">README file</a> that accompanies the Quarkus application used in this example.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you install the Helm chart, Helm automatically processes the contents of the chart <code>/templates</code> directory. Helm uses the templates to generate manifests for deployment of the application and creation of a service for the application. Helm provides these manifests to OpenShift.</p>
</div>
</li>
<li>
<p>When the Helm chart is installed, get the service endpoint for the application on OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ oc get service</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see output like the following example:</p>
</div>
<div class="listingblock">
<div class="title">Service information for running Quarkus application on OpenShift</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-shell" data-lang="shell">NAME                                TYPE           CLUSTER-IP       EXTERNAL-IP                                                               PORT(S)          AGE
rhoas-quarkus-kafka-quickstart      LoadBalancer   172.30.128.12    a81b115a35629488685b6ed3cf322fbf-1904626303.us-east-2.elb.amazonaws.com   8080:31110/TCP   11m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output indicates that the Quarkus application is successfully running on your OpenShift cluster.</p>
</div>
</li>
<li>
<p>On the command line, copy the value shown under <strong>EXTERNAL-IP</strong>.</p>
</li>
<li>
<p>In a web browser, go to <code><em>&lt;external-ip-value&gt;</em>:8080/prices.html</code>.</p>
<div class="paragraph">
<p>You see that the web page continuously updates the <code>Last price</code> value. The continuously updating output shows that the Quarkus application is using the connection configuration information that you generated to connect to the Kafka instance defined in your service context. The application uses the <code>prices</code> topic that you created to produce and consume messages.</p>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_application_services/1/guide/8bd088a6-b7b7-4e5d-832a-b0f0494f9070#_b7f033ec-6f0c-4b3c-89b0-cb1801de19f9" target="_blank" rel="noopener">CLI command reference (rhoas)</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_streams_for_apache_kafka/1/guide/2f4bf7cf-5de2-4254-8274-6bf71673f407" target="_blank" rel="noopener"> Managing account access in OpenShift Streams for Apache Kafka</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-03-01 21:27:08 UTC
</div>
</div>
</body>
</html>