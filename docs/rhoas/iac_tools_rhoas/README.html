<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Automating deployment and management of Kafka instances in OpenShift Streams for Apache Kafka</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body id="chap-using-iac-tools" class="article">
<div id="header">
<h1>Automating deployment and management of Kafka instances in OpenShift Streams for Apache Kafka</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a system administrator of applications and services, you can use Infrastructure as Code (IaC) tools to automate deployment and management of architectures.</p>
</div>
<div class="paragraph">
<p>This guide describes how to use different IaC tools to provision and manage Kafka instances in OpenShift Streams for Apache Kafka. To interact with Kafka instances, the IaC tools use two REST APIs that are available in Streams for Apache Kafka - a <em>management</em> API and an <em>instance</em> API.</p>
</div>
<div class="paragraph">
<p>For more information about creating and setting up Kafka instances, see <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/getting-started-kafka/README.adoc" target="_blank" rel="noopener">Getting started with OpenShift Streams for Apache Kafka</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-ansible_using-iac-tools">Ansible</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p><a href="https://www.ansible.com/overview/how-ansible-works" target="_blank" rel="noopener">Ansible</a> is an open source configuration management and automation tool.</p>
</div>
<div class="paragraph">
<p>Ansible uses <em>modules</em> to execute tasks. The output of one module can be the input for the next one or they can be independent of each other.</p>
</div>
<div class="paragraph">
<p>You can combine one or more Ansible modules to make a play. Combine two or more plays to create an Ansible playbook, a list of sequential tasks (written in YAML) that automatically executes when you run the <code>ansible-playbook</code> command. You can use an Ansible playbook to describe the desired state of your infrastructure and then have Ansible provision it.</p>
</div>
<div class="paragraph">
<p>An Ansible role is a special kind of playbook that is fully self-contained and portable with the tasks, variables, configuration templates, and other supporting files that are needed to complete your chosen tasks. Multiple roles can exist inside a collection, allowing easy sharing of content through Automation Hub and <a href="https://galaxy.ansible.com" target="_blank" rel="noopener">Ansible Galaxy</a>.</p>
</div>
<div class="sect2">
<h3 id="proc-install-rhoas-ansible-collection_using-iac-tools">Installing the OpenShift Application Services Ansible collection</h3>
<div class="paragraph _abstract">
<p>The following procedure shows how to install the OpenShift Application Services (RHOAS) <a href="https://galaxy.ansible.com/rhoas/rhoas" target="_blank" rel="noopener">Ansible collection</a> allowing you to fully manage your Kafka environment with Ansible.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.python.org/downloads/" target="_blank" rel="noopener">Python 3.9</a> or later is installed.</p>
</li>
<li>
<p><a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html?extIdCarryOver=true&amp;sc_cid=701f2000001Css5AAC" target="_blank" rel="noopener">Ansible 2.9</a> or later is installed.</p>
</li>
<li>
<p>Some additional dependencies required by this collection are installed. To install these, enter the following commands:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ pip install rhoas-sdks
$ pip install python-dotenv</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Use the <code>pip install rhoas-sdks --force reinstall</code> command to ensure that the most up to date versions of the SDKs are installed.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open a new terminal window.</p>
</li>
<li>
<p>Create a Python virtual environment.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ python3 -m venv rhoas</code></pre>
</div>
</div>
</li>
<li>
<p>Activate the virtual environment.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ . rhoas/bin/activate</code></pre>
</div>
</div>
</li>
<li>
<p>Install the RHOAS Ansible collection.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ ansible-galaxy collection install rhoas.rhoas</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the <code>ansible-galaxy collection install</code> command uses <code>https://galaxy.ansible.com</code> as the Galaxy server URL. The URL is specified as the value of the <code>GALAXY_SERVER</code> parameter in the <code>ansible.cfg</code> configuration file.</p>
</div>
<div class="paragraph">
<p>A message states that the RHOAS collection was installed successfully to the following path: <code>home/<em>&lt;usr&gt;</em>/.ansible/collections/ansible_collections/rhoas/rhoas</code>. All modules for the collection can be found in this location.</p>
</div>
<div class="paragraph">
<p>When installed, you can reference collection content by the fully qualified collection name (FQCN) of the collection. The command in a task needs to include the FQCN of the module so it always points to the intended collection. For example, the FQCN for the <code>create_kafka</code> command is
<code>rhoas.rhoas.create_kafka</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To find documentation for each module, open a terminal window, enter <code>ansible-doc rhoas.rhoas.<em>&lt;module_name&gt;</em></code> and replace <em>&lt;module_name&gt;</em> with the name of the module in the terminal. The following example outputs the documentation for the <code>create_kafka</code> module. The documentation shows required parameters (denoted by <code>=</code>) and optional parameters (denoted by <code>-</code>) for the module, as well as examples of how to use the module and the output. If you do not pass in any values for optional fields, Ansible uses the default values from the Kafka APIs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ ansible-doc rhoas.rhoas.create_kafka</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-using-rhoas-ansible-collection_using-iac-tools">Using the OpenShift Application Services Ansible collection</h3>
<div class="paragraph _abstract">
<p>You can create, view, configure, and delete the following OpenShift Streams for Apache Kafka resources with the OpenShift Application Services (RHOAS) collection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kafka instances</p>
</li>
<li>
<p>Service accounts</p>
</li>
<li>
<p>Kafka topics</p>
</li>
<li>
<p>Access Control Lists (ACLs)</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a Red Hat account.</p>
</li>
<li>
<p>You have an offline token used to authenticate the Ansible modules with the OpenShift Application Services API.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The offline token is a refresh token with no expiry and can be used by non-interactive processes to provide an access token for OpenShift Application Services to authenticate the user. The token is an OpenShift offline token and you can find it at <a href="https://cloud.redhat.com/openshift/token" class="bare">https://cloud.redhat.com/openshift/token</a>.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your IDE, create a new environment variables (<code>.env</code>) file.</p>
</li>
<li>
<p>In the <code>.env</code> file, add the following variables required by the Ansible collection:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>API_BASE_HOST</code></dt>
<dd>
<p>This is the base URL for the API. For example, <code>https://api.openshift.com</code>.</p>
</dd>
<dt class="hdlist1"><code>SSO_BASE_HOST</code></dt>
<dd>
<p>This is the base URL for the Red Hat single sign-on (SSO) service. For example, <code>https://sso.redhat.com/auth/realms/redhat-external</code>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Save the file in the root directory of the Ansible collection.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you do not explicitly define the environment variables, the collection uses the URLs shown in the preceding step.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You can run a module in a terminal window to perform a single task. For example, the following command shows how to run a module that creates a Kafka instance. Replace <em>&lt;OFFLINE_TOKEN&gt;</em> with your OpenShift offline token.</p>
<div class="listingblock">
<div class="title">Example create_kafka module</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ ansible localhost -m rhoas.rhoas.create_kafka -a 'name=unique-kafka-name billing_model=standard cloud_provider=aws plan="developer.x1" region="us-east-1" openshift_offline_token=&lt;OFFLINE_TOKEN&gt;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ansible runs the <code>rhoas.rhoas.create_kafka</code> task in the terminal and creates the instance.</p>
</div>
<div class="paragraph">
<p>You can also create a playbook of sequential tasks and use Ansible to automatically execute those tasks. The steps in the next section show you how to create and run an example playbook.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-creating-playbook-ansible_using-iac-tools">Creating a playbook</h3>
<div class="paragraph _abstract">
<p>The example playbook in this section includes modules for creating a Kafka instance, topic, and service account, and for assigning permissions to the service account. You also configure modules to delete the resources that you previously created.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To open the example playbook used in this section, use your IDE to navigate to the <code>rhoas</code> folder in the <code>.ansible</code> directory.</p>
</li>
<li>
<p>Open the <code>rhoas_test</code> example playbook.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can also open a web browser to view the <a href="https://github.com/redhat-developer/app-services-ansible/blob/main/rhoas_test.yml" target="_blank" rel="noopener"><code>rhoas_test</code> playbook</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Inspect the contents of the example playbook. In particular, observe that the playbook has modules for certain tasks. You will use these modules to create a new playbook that performs the following tasks:</p>
<div class="ulist">
<ul>
<li>
<p>Creating and deleting a Kafka instance</p>
</li>
<li>
<p>Creating and deleting a service account</p>
</li>
<li>
<p>Creating Access Control List (ACL) permission bindings</p>
</li>
<li>
<p>Creating, updating, and deleting a topic</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The playbook uses your offline token to authenticate with the Kafka Management API. If you do not specify the token as an argument for a given task, the module attempts to read it from the <code>OFFLINE_TOKEN</code> environment variable.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The example playbook used in this section includes comments that indicate how to directly specify values rather than fetching them dynamically. For example, to specify a Kafka instance ID, a comment in the playbook states that you can include the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kafka_id: <em>&lt;kafka_id&gt;</em></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In your IDE, create a new playbook file and save it as <code>rhoas_kafka.yml</code> in the <code>rhoas</code> directory.</p>
</li>
<li>
<p>At the start of the new playbook, you define the name of the playbook and the group of hosts on which to run it. Copy the following example and paste it into the <code>rhoas_kafka.yml</code> file. In this example, the host is a local host and the connection is local because you are in a virtual environment.</p>
<div class="listingblock">
<div class="title">Example first section for <code>rhoas_kafka</code> playbook</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: RHOAS kafka
  hosts: localhost
  gather_facts: false
  connection: local
  tasks:</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="proc-creating-kafka-instance-ansible_using-iac-tools">Creating a Kafka instance</h4>
<div class="paragraph _abstract">
<p>To manage a Kafka instance using Ansible, you can use the <code>create_kafka</code> module and run it as part of a playbook or  as a single module.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a Red Hat account.</p>
</li>
<li>
<p>You have an offline token that authenticates the Ansible modules with the OpenShift Application Services API.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To add a module that creates a new Kafka instance to a playbook, copy the <code>create_kafka</code> module shown in the following example and paste it into the <code>tasks:</code> section of your <code>rhoas_kafka.yml</code> file.</p>
<div class="listingblock">
<div class="title">Example <code>create_kafka</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Create kafka
    rhoas.rhoas.create_kafka:
      name: "kafka-name"
      instance_type: "x1"
      billing_model: "standard"
      cloud_provider: "aws"
      region: "us-east-1"
      plan: "developer.x1"
      billing_cloud_account_id: "123456789"
      openshift_offline_token: "OPENSHIFT_OFFLINE_TOKEN"
    register:
      kafka_req_resp</code></pre>
</div>
</div>
</li>
<li>
<p>In the <code>name</code> field, enter a name for the Kafka instance.</p>
</li>
<li>
<p>In the <code>billing_cloud_account_id</code>, enter the billing cloud account ID.</p>
</li>
<li>
<p>In the <code>openshift_offline_token</code> field, enter your OpenShift offline token.</p>
<div class="paragraph">
<p>All other information for the instance is provided by the Kafka APIs.</p>
</div>
<div class="paragraph">
<p>When you run the <code>create_kafka_</code> module as part of the playbook at the end of these steps, Ansible saves the output of that command in a variable in the <code>register</code> field. In the preceding example, Ansible saves the created Kafka instance as <code>kafka_req_resp</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-creating-service-account-ansible_using-iac-tools">Creating a service account</h4>
<div class="paragraph _abstract">
<p>To connect your applications or services to a Kafka instance in Streams for Apache Kafka, you must first create a service account with credentials.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an offline token that authenticates the Ansible modules with the OpenShift Application Services API.</p>
</li>
<li>
<p>You have created a Kafka instance.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To add a module that creates a service account, copy the <code>create_service_account</code> module shown in the following example and paste it into the <code>rhoas_kafka.yml</code> file.</p>
<div class="listingblock">
<div class="title">Example <code>create_service_account</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Create Service Account
    create_service_account:
      name: "service-account-name"
      description: "This is a description of the service account"
      openshift_offline_token: "OPENSHIFT_OFFLINE_TOKEN"
    register:
      srvce_acc_resp_obj</code></pre>
</div>
</div>
</li>
<li>
<p>Enter values for the <code>name</code>, <code>short description</code>, and <code>openshift_offline_token</code> fields.</p>
<div class="paragraph">
<p>When you run the <code>create_service_account</code> module as part of the playbook at the end of these steps, Ansible populates the generated service account credentials in the <code>client_id</code> and <code>client_secret</code> fields in the terminal after it creates the service account.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-creating-acl-permissions-ansible_using-iac-tools">Creating Access Control List permissions</h4>
<div class="paragraph _abstract">
<p>After you create a service account to connect to a Kafka instance, you must also set the appropriate level of access for that new account in an Access Control List (ACL) for the Kafka instance.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an offline token that authenticates the Ansible modules with the OpenShift Application Services API.</p>
</li>
<li>
<p>You have created a Kafka instance.</p>
</li>
<li>
<p>You understand how Access Control Lists (ACLs) enable you to manage how user accounts and service accounts can access the Kafka resources that you create. See <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/access-mgmt-kafka/README.adoc" target="_blank" rel="noopener">Managing account access in OpenShift Streams for Apache Kafka</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To create Access Control List (ACL) permissions for the service account and bind that ACL to the Kafka instance, copy the <code>create_kafka_acl_binding</code> module shown in the following example and paste it in your <code>rhoas_kafka.yml</code> file.</p>
<div class="listingblock">
<div class="title">Example <code>create_kafka_acl_binding</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Create kafka ACL Service Binding
    rhoas.rhoas.create_kafka_acl_binding:
      kafka_id: "{{ kafka_req_resp.kafka_id }}"
      # To hard code the kafka_id, uncomment and use the following line:
      # kafka_id: "KAFKA_ID"
      principal: " {{ srvce_acc_resp_obj['client_id'] }}"
      # To hard code the principal_id, uncomment and use the following line:
      # principal: "PRINCIPAL_ID"
      resource_name: "topic-name"
      resource_type: "Topic"
      pattern_type: "PREFIXED"
      operation_type: "all"
      permission_type: "allow"
      openshift_offline_token: "OPENSHIFT_OFFLINE_TOKEN"
    register: kafka_acl_resp</code></pre>
</div>
</div>
</li>
<li>
<p>To directly specify a Kafka instance ID, enter a value in the <code>kafka_id</code> field. Otherwise, Ansible gets the Kafka ID from the <code>kafka_req_resp.id</code> variable.</p>
</li>
<li>
<p>In the <code>openshift_offline_token</code> field, enter your OpenShift offline token.</p>
</li>
<li>
<p>Consider whether you need to specify your own value for any of the fields in the following list. These fields must all have values in an ACL binding module.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>principal</code></dt>
<dd>
<p>The user or service account that this binding applies to. This example uses the service account client ID.</p>
</dd>
<dt class="hdlist1"><code>resource_name</code></dt>
<dd>
<p>The Kafka resource that you are granting access to. This example specifies the Kafka topic that you create in the playbook.</p>
</dd>
<dt class="hdlist1"><code>resource_type</code></dt>
<dd>
<p>The type of resource you grant access to. This example uses <strong>Topic</strong>.</p>
</dd>
<dt class="hdlist1"><code>pattern_type</code></dt>
<dd>
<p>The type of pattern of the ACL. This example uses the <code>PREFIXED</code> pattern type meaning that Kafka will try to match the prefix of the resource name with the resource specified in the ACL.</p>
</dd>
<dt class="hdlist1"><code>operation_type</code></dt>
<dd>
<p>The type of operation (an action performed on a resource) that is allowed for the given user on this module.</p>
</dd>
<dt class="hdlist1"><code>permission_type</code></dt>
<dd>
<p>Whether permission is given to the user or taken away.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-configuring-kafka-topic-ansible_using-iac-tools">Configuring a Kafka topic</h4>
<div class="paragraph _abstract">
<p>After you create a Kafka instance, you can create Kafka topics to start producing and consuming messages in your applications and services.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an offline token that authenticates the Ansible modules with the Kafka Management API.</p>
</li>
<li>
<p>You have created a Kafka instance.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To create a Kafka topic, copy the contents of the <code>create_kafka_topic</code> module shown in the following example and paste it into the <code>rhoas_kafka.yml</code> file.</p>
<div class="listingblock">
<div class="title">Example <code>create_kafka_topic</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Create Kafka Topic
    create_kafka_topic:
      topic_name: "kafka-topic-name"
      kafka_id: "{{ kafka_req_resp.id }}"
      # To hard code the kafka_id, uncomment and use the following line:
      # kafka_id: "KAFKA_ID"
      partitions: 1
      retention_period_ms: "86400000"
      retention_size_bytes: "1073741824"
      cleanup_policy: "compact"
      openshift_offline_token: "OPENSHIFT_OFFLINE_TOKEN"
    register:
      create_topic_res_obj</code></pre>
</div>
</div>
</li>
<li>
<p>To directly specify a Kafka instance ID, enter a value in the <code>kafka_id</code> field. Otherwise, Ansible gets the Kafka ID from the <code>kafka_req_resp.id</code> variable.</p>
</li>
<li>
<p>In the <code>openshift_offline_token</code> field, enter your OpenShift offline token.</p>
</li>
<li>
<p>To update the configuration of the topic, copy the <code>update_kafka_topic</code> module shown in the following example and paste it into the <code>rhoas_kafka</code> file. In the following example, the cleanup policy has been updated from compact to delete by replacing <code>"compact"</code> with <code>"delete"</code> in the <code>cleanup_policy</code> field.</p>
<div class="listingblock">
<div class="title">Example <code>update_kafka_topic</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Update Kafka Topic
    update_kafka_topic:
      topic_name: "kafka-topic-name"
      kafka_id: "{{ kafka_req_resp.id }}"
      # To hard code the kafka_id, uncomment and use the following line:
      # kafka_id: "KAFKA_ID"
      partitions: 1
      retention_period_ms: "86400000"
      retention_size_bytes: "1073741824"
      cleanup_policy: "delete"
      openshift_offline_token: "OPENSHIFT_OFFLINE_TOKEN"
    register:
      update_topic_res_obj</code></pre>
</div>
</div>
</li>
<li>
<p>To directly specify a Kafka instance ID, enter a value in the <code>kafka_id</code> field. Otherwise, Ansible gets the Kafka ID from the <code>kafka_req_resp.id</code> variable.</p>
</li>
<li>
<p>(Optional) You can modify the values in the <code>retention_period_ms</code> and <code>retention_size_bytes</code> fields instead of accepting the default values.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-deleting-topic-ansible_using-iac-tools">Deleting a Kafka topic</h4>
<div class="paragraph _abstract">
<p>To delete a topic, use the <code>delete_kafka_topic</code> module.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copy the <code>delete_kafka_topic</code> module shown in the following example and paste it into the <code>rhoas_kafka.yml</code> file.</p>
<div class="listingblock">
<div class="title">Example <code>delete_kafka_topic</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Delete Kafka Topic
   rhoas.rhoas.delete_kafka_topic:
     topic_name: "KAFKA_TOPIC_NAME"
      kafka_id: "{{ kafka_req_resp_obj['kafka_id'] }}"
      # To hard code the kafka_id, uncomment and use the following line:
      # kafka_id: "KAFKA_ID"
     openshift_offline_token: "OPENSHIFT_OFFLINE_TOKEN"</code></pre>
</div>
</div>
</li>
<li>
<p>In the <code>openshift_offline_token</code> field, enter your OpenShift offline token.</p>
</li>
<li>
<p>To directly specify a Kafka instance ID, enter a value in the <code>kafka_id</code> field. Otherwise, Ansible gets the Kafka ID from the <code>kafka_req_resp.id</code> variable.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-deleting-service-account-ansible_using-iac-tools">Deleting a service account</h4>
<div class="paragraph _abstract">
<p>To delete a service account, use the <code>delete_service_account_by_id</code> module.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a service account.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To delete the service account, copy the <code>delete_service_account_by_id</code> module shown in the following example and paste it into the <code>rhoas_kafka.yml</code> file.</p>
</li>
<li>
<p>To directly specify a service account ID, enter a value in the <code>service_account_id</code> field. Otherwise, Ansible gets the service account ID from the <code>srvce_acc_resp_obj</code> variable.</p>
<div class="listingblock">
<div class="title">Example <code>deleting_service_account_by_id</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Delete Service Account
   rhoas.rhoas.delete_service_account_by_id:
   # service_account_id: "service_account_id"
  service_account_id: "{{ srvce_acc_resp_obj['client_id'] }}"

  # openshift_offline_token: "OFFLINE_TOKEN"</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-deleting-kafka-instance-ansible_using-iac-tools">Deleting a Kafka instance</h4>
<div class="paragraph _abstract">
<p>To delete a Kafka instance, use the <code>delete_kafka_by_id</code> module.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a Kafka instance.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To deprovision and delete the Streams for Apache Kafka instance, copy the <code>delete_kafka_by_id</code> module shown in the following example and paste it into the <code>rhoas_kafka.yml</code> file.</p>
<div class="listingblock">
<div class="title">Example <code>delete_kafka_by_id</code> module</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Delete kafka instance by ID
    rhoas.rhoas.delete_kafka_by_id:
     kafka_id: "{{ kafka_req_resp_obj['kafka_id'] }}"
     openshift_offline_token: "offline_token"</code></pre>
</div>
</div>
</li>
<li>
<p>In the <code>openshift_offline_token</code> field, enter your OpenShift offline token.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-running-playbook-ansible_using-iac-tools">Running the playbook</h4>
<div class="paragraph _abstract">
<p>When you have finished creating the resources, run the playbook.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Save any changes you have made to the the example <code>rhoas_test</code> playbook.</p>
</li>
<li>
<p>Open a terminal and enter the following command to run the playbook:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ ansible-playbook rhoas_kafka.yml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The playbook runs through the tasks sequentially, generating output in the terminal window. When finished, Ansible displays a <code>PLAY RECAP</code> message stating that all 8 tasks have an <code>ok</code> status, meaning they have all run successfully.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-terraform_using-iac-tools">Terraform</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p><a href="https://www.terraform.io/" target="_blank" rel="noopener">HashiCorp Terraform</a> is an Infrastructure as Code (Iac) tool that enables you to build and change infrastructure safely and efficiently through human-readable configuration files that you can create versions of, reuse, and share. You can then use a consistent workflow to provision and manage all of your infrastructure throughout its lifecycle.</p>
</div>
<div class="sect2">
<h3 id="proc-install-rhoas-terraform-provider_using-iac-tools">Installing the OpenShift Application Services Terraform provider</h3>
<div class="paragraph _abstract">
<p>You can fully manage your Kafka environment through your Terraform system using the OpenShift Application Services (RHOAS) <a href="https://registry.terraform.io/providers/redhat-developer/rhoas/latest" target="_blank" rel="noopener">Terraform</a> provider, which is available in the official <a href="https://www.terraform.io/" target="_blank" rel="noopener">Terraform provider registry</a>.</p>
</div>
<div class="paragraph">
<p>You can create, view, configure, and delete the following Streams for Apache Kafka resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kafka instances</p>
</li>
<li>
<p>Service accounts</p>
</li>
<li>
<p>Kafka topics</p>
</li>
<li>
<p>Access Control Lists (ACLs)</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a Red Hat account.</p>
</li>
<li>
<p><a href="https://www.terraform.io/downloads" target="_blank" rel="noopener">Terraform</a> v1.3.4 or later is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your web browser, navigate to the <a href="https://registry.terraform.io/providers/redhat-developer/rhoas/latest" target="_blank" rel="noopener">OpenShift Application Services (RHOAS) Terraform provider</a>.</p>
</li>
<li>
<p>In the upper-right corner of the RHOAS Terraform provider registry, click <strong>Use Provider</strong>.</p>
<div class="paragraph">
<p>A pane opens that shows the configuration you need to use the RHOAS Terraform provider.</p>
</div>
</li>
<li>
<p>In the pane that opened, copy the configuration shown. The following lines show an example of the configuration.</p>
<div class="listingblock">
<div class="title">Example RHOAS provider configuration</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">terraform {
  required_providers {
    rhoas = {
      source = "redhat-developer/rhoas"
      version = "0.4.0"
    }
  }
}

provider "rhoas" {
  #configuration options
}</code></pre>
</div>
</div>
</li>
<li>
<p>In your IDE, open a new file and paste the configuration you copied. You can specify configuration options in the <code>provider</code> section.</p>
</li>
<li>
<p>Save the file as a Terraform configuration file called <code>main.tf</code> in a directory of your choice. This procedure uses a directory called <code>Terraform</code>.</p>
</li>
<li>
<p>Open a terminal and navigate to the <code>Terraform</code> directory.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ cd Terraform</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command. This command initializes the working directory that contains Terraform configuration files and installs any required plug-ins.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ terraform init</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the Terraform provider has been initialized, you see a confirmation message.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="con-using-terraform_using-iac-tools">Using the OpenShift Application Services Terraform provider</h3>
<div class="paragraph _abstract">
<p>Resources are the most important element in the Terraform language. Each resource block in a Terraform provider describes one or more infrastructure objects. For OpenShift Streams for Apache Kafka, such infrastructure objects might include Kafka instances, service accounts, Access Control Lists (ACLs), and topics. The procedures that follow show what resources you can add to your Terraform configuration file to create a Kafka instance and its associated resources such as service accounts and topics.</p>
</div>
<div class="sect3">
<h4 id="proc-creating-kafka-instance-terraform_using-iac-tools">Creating a Kafka instance</h4>
<div class="paragraph _abstract">
<p>To manage a Kafka instance using Terraform, use the <code>rhoas_kafka</code> resource.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a Red Hat account.</p>
</li>
<li>
<p>You have an offline token that authenticates the Terraform resources with the OpenShift Application Services API.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The offline token is a refresh token with no expiry and can be used by non-interactive processes to provide an access token for OpenShift Application Services to authenticate the user. The token is an OpenShift offline token and you can find it at <a href="https://cloud.redhat.com/openshift/token" class="bare">https://cloud.redhat.com/openshift/token</a>. Because the offline token is a sensitive value that varies between environments it is best specified as an <code>OFFLINE_TOKEN</code> environment variable when running <code>terraform apply</code> in a terminal. To set this environment variable, enter the following command in a terminal window, replacing <em>&lt;offline_token&gt;</em> with the value of the offline token:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>export OFFLINE_TOKEN=<em>&lt;offline_token&gt;</em></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open the <code>main.tf</code> file in your IDE for editing.</p>
</li>
<li>
<p>Copy the <code>rhoas_kafka</code> resource shown in the following example and paste it into the <code>main.tf</code> file after the provider configuration. This example uses the <code>"my-instance"</code> identifier and creates a Kafka instance called <code>my-instance</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In the following examples, the identifier and the name of the infrastructure object are the same for demonstration purposes only. You can choose different values for each field.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example <code>rhoas_kafka</code> resource</div>
<div class="content">
<pre class="highlight"><code>resource "rhoas_kafka" "my-instance" {
  name = "my-instance"
  plan = "developer.x1"
  billing_model = "standard"
}
  output "bootstrap_server_my-instance" {
    value = rhoas_kafka.my-instance.bootstrap_server_host
}</code></pre>
</div>
</div>
</li>
<li>
<p>Save your changes.</p>
</li>
<li>
<p>Open a terminal and apply the changes you made to your Terraform provider configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ terraform apply</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the terminal, Terraform displays a message that <code>rhoas_kafka.my-instance</code> will be created. Terraform automatically sets values for <code>cloud provider</code> and <code>region</code> in the terminal. All other information for the instance is provided by the Kafka APIs.</p>
</div>
</li>
<li>
<p>When you&#8217;re ready to create your instance,  type <strong>yes</strong>. The generated bootstrap server URL appears in the terminal as an output.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Running <code>terraform apply</code> for the first time also creates the Terraform state file. Terraform logs information about the resources it has created in this state file. This allows Terraform to know which resources are under its control and when to update and delete them. The Terraform state file is named <code>terraform.tfstate</code> by default and is kept in the same directory where Terraform is run. Sensitive information such as the offline token, client ID, and client secret can be found in the <code>terraform.tfstate</code> file. Running <code>terraform apply</code> again updates this file.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>To verify Terraform successfully created your Kafka instance, in your web browser, open the <strong>Kafka Instances</strong> page of the Streams for Apache Kafka <a href="https://console.redhat.com/application-services/streams/" target="_blank" rel="noopener">web console</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-creating-service-account-terraform_using-iac-tools">Creating a service account</h4>
<div class="paragraph _abstract">
<p>To connect your applications or services to a Kafka instance in Streams for Apache Kafka, you must first create a service account with credentials.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an offline token that authenticates the Terraform resources with the OpenShift Application Services API.</p>
</li>
<li>
<p>You have created a Kafka instance.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To create a service account, copy and paste the  <code>rhoas_service_account</code> resource shown in the following example into the <code>main.tf</code> file. This example uses the <code>"my-service-account"</code> identifier and creates a service account called <code>my-service-account</code>.</p>
<div class="listingblock">
<div class="title">Example <code>rhoas_service_account</code> resource</div>
<div class="content">
<pre class="highlight"><code>resource "rhoas_service_account" "my-service-account" {
  name        = "my-service-account"
  description = "&lt;description of service account&gt;"
}

output "client_id" {
  value = rhoas_service_account.my-service-account.client_id
}

output "client_secret" {
  value     = rhoas_service_account.my-service-account.client_secret
  sensitive = true
}</code></pre>
</div>
</div>
</li>
<li>
<p>Save your changes.</p>
</li>
<li>
<p>Apply the changes you made to your Terraform provider configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ terraform apply</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the terminal, Terraform displays a message that <code>rhoas_service_account.my-service-account</code> will be created.</p>
</div>
</li>
<li>
<p>When you&#8217;re ready to create your service account, type <strong>yes</strong>. The generated client ID appears in the terminal as an output. The client secret does not appear because it is marked as a sensitive value.</p>
</li>
<li>
<p>To verify Terraform successfully created your service account, in your web browser, open the <strong>Service Accounts</strong> page of the Streams for Apache Kafka <a href="https://console.redhat.com/application-services/streams/" target="_blank" rel="noopener">web console</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-creating-acl-permissions-terraform_using-iac-tools">Creating Access Control List permissions</h4>
<div class="paragraph _abstract">
<p>After you create a service account to connect to a Kafka instance, you must also set the appropriate level of access for that new account in an Access Control List (ACL) for the Kafka instance.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an offline token that authenticates the Terraform resources with the OpenShift Application Services API.</p>
</li>
<li>
<p>You have created a Kafka instance.</p>
</li>
<li>
<p>You understand how Access Control Lists (ACLs) enable you to manage how user accounts and service accounts can access the Kafka resources that you create. See <a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/access-mgmt-kafka/README.adoc" target="_blank" rel="noopener">Managing account access in OpenShift Streams for Apache Kafka</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To create Access Control List (ACL) permissions with some default values, copy and paste the <code>rhoas_acl</code> resource shown in the following example into the <code>main.tf</code> file. This example uses the <code>"acl"</code> identifier.</p>
<div class="listingblock">
<div class="title">Example <code>ACL binding</code> resource</div>
<div class="content">
<pre class="highlight"><code>resource "rhoas_acl" "acl" {
  kafka_id = rhoas_kafka.my-instance.id
  resource_type = "TOPIC"
  resource_name = "my-topic"
  pattern_type = "LITERAL"
  principal = rhoas_service_account.my-service-account.client_id
  operation_type = "ALL"
  permission_type = "ALLOW"
}</code></pre>
</div>
</div>
</li>
<li>
<p>Consider whether you need to specify your own value for any of the fields in the following list. These fields must all have values in an ACL binding resource.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>resource_type</code></dt>
<dd>
<p>The type of resource you grant access to. This example uses <code>“TOPIC”</code>.</p>
</dd>
<dt class="hdlist1"><code>resource_name</code></dt>
<dd>
<p>The name of the Kafka resource  you grant access to. This example uses the name that is passed when creating the topic.</p>
</dd>
<dt class="hdlist1"><code>pattern_type</code></dt>
<dd>
<p>The type of pattern of the ACL. This example uses the <code>LITERAL</code> pattern type meaning that Kafka will try to match the match the full resource name (the topic) with the resource specified in the ACL.</p>
</dd>
<dt class="hdlist1"><code>principal</code></dt>
<dd>
<p>The user or service account that this binding applies to. This example uses the service account client ID.</p>
</dd>
<dt class="hdlist1"><code>operation_type</code></dt>
<dd>
<p>The type of operation (an action performed on a resource) that is allowed for the given user on this resource.</p>
</dd>
<dt class="hdlist1"><code>permission_type</code></dt>
<dd>
<p>Whether permission is given or taken away.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Save your changes.</p>
</li>
<li>
<p>Apply the changes you made to your Terraform provider configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ terraform apply</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the terminal, Terraform displays a message that <code>rhoas_acl.acl.</code> will be created.</p>
</div>
</li>
<li>
<p>When you&#8217;re ready to set your permissions, type <strong>yes</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-creating-kafka-topic-terraform_using-iac-tools">Creating a Kafka topic</h4>
<div class="paragraph _abstract">
<p>After you create a Kafka instance, you can create Kafka topics to start producing and consuming messages in your applications and services.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an offline token that authenticates the Terraform resources with the OpenShift Application Services API.</p>
</li>
<li>
<p>You have created a Kafka instance.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To create a Kafka topic with default values, copy and paste the <code>rhoas_topic</code> resource shown in the following example into the <code>main.tf</code> file. This example uses the <code>topic</code> identifier and creates the <code>my-topic</code> Kafka topic. Because you have already created the Kafka instance, Terraform can check dependencies for this new topic resource and knows the Kafka ID when you run this example resource.</p>
<div class="listingblock">
<div class="title">Example <code>rhoas_topic</code> resource with default values</div>
<div class="content">
<pre class="highlight"><code>resource "rhoas_topic" "topic" {
		name = "my-topic"
		partitions = 1
		kafka_id = rhoas_kafka.instance.id
	}</code></pre>
</div>
</div>
</li>
<li>
<p>Save your changes.</p>
</li>
<li>
<p>Apply the changes you made to your Terraform provider configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ terraform apply</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the terminal, Terraform displays a message that <code>rhoas_topic.my-topic</code> will be created.</p>
</div>
</li>
<li>
<p>When you&#8217;re ready to create your topic, type <strong>yes</strong>.</p>
</li>
<li>
<p>To verify Terraform successfully created your topic, in your web browser, open the <strong>Topics</strong> page of the Streams for Apache Kafka <a href="https://console.redhat.com/application-services/streams/" target="_blank" rel="noopener">web console</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-deleting-resources_using-iac-tools">Deleting resources</h4>
<div class="paragraph _abstract">
<p>You can delete the resources you have created when you have finished using them.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created Terraform resources.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To delete the created resources, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ terraform destroy</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-data-sources_using-iac-tools">Data sources</h3>
<div class="paragraph _abstract">
<p>In Terraform, you can use data sources to obtain information about resources external to Terraform, defined by another separate Terraform configuration, or modified by functions using the data block. Apply data sources in the same way that you add resources to the configuration file. The following <code>rhoas_kafkas</code> <a href="https://registry.terraform.io/providers/redhat-developer/rhoas/latest/docs">data source</a> example provides a list of the Kafka instances accessible to your organization in OpenShift Streams for Apache Kafka.</p>
</div>
<div class="listingblock">
<div class="title">Example <code>rhoas_kafkas</code> data source</div>
<div class="content">
<pre class="highlight"><code>terraform {
  required_providers {
    rhoas = {
      source  = "registry.terraform.io/redhat-developer/rhoas"
      version = "0.4.0"
    }
  }
}

provider "rhoas" {}

data "rhoas_kafkas" "all" {
}

output "all_kafkas" {
  value = data.rhoas_kafkas.all
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 _additional-resources">
<h2 id="_additional_resources">Additional resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/getting-started-kafka/README.adoc" target="_blank" rel="noopener">Getting started with OpenShift Streams for Apache Kafka</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_streams_for_apache_kafka/1/guide/7d28aec8-e146-44db-a4a5-fafc1f426ca5" target="_blank" rel="noopener">Configuring topics in OpenShift Streams for Apache Kafka</a></p>
</li>
<li>
<p><a href="https://github.com/redhat-developer/app-services-guides/tree/main/docs/kafka/access-mgmt-kafka/README.adoc" target="_blank" rel="noopener">Managing account access in OpenShift Streams for Apache Kafka</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-03-01 21:27:08 UTC
</div>
</div>
</body>
</html>